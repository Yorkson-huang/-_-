2025-05-15 15:26:31,572 - time_series - INFO - 开始运行时间序列预测系统
2025-05-15 15:26:31,572 - time_series - INFO - 日志文件: time_series/logs\time_series_prediction_20250515_152631.log
2025-05-15 15:26:31,572 - data_utils - INFO - 正在加载数据集: time_series\北京-逐日.xlsx
2025-05-15 15:26:32,991 - data_utils - INFO - 数据集加载成功，形状: (27814, 3)
2025-05-15 15:26:32,991 - data_utils - INFO - 提取的AQI数据形状: (27814,)
2025-05-15 15:26:33,014 - data_utils - INFO - 创建的序列形状: X=(27807, 7), y=(27807,)
2025-05-15 15:26:33,015 - data_utils - INFO - 训练集形状: X=(19464, 7), y=(19464,)
2025-05-15 15:26:33,015 - data_utils - INFO - 验证集形状: X=(2780, 7), y=(2780,)
2025-05-15 15:26:33,015 - data_utils - INFO - 测试集形状: X=(5563, 7), y=(5563,)
2025-05-15 15:26:33,016 - data_processor - INFO - 数据处理器初始化，序列长度: 7, 批次大小: 32
2025-05-15 15:26:33,016 - time_series - INFO - ==================================================
2025-05-15 15:26:33,016 - time_series - INFO - 开始LSTM模型训练和预测
2025-05-15 15:26:33,020 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 15:26:33,020 - data_processor - INFO - 训练批次数: 609
2025-05-15 15:26:33,021 - data_processor - INFO - 验证批次数: 87
2025-05-15 15:26:33,021 - data_processor - INFO - 测试批次数: 174
2025-05-15 15:26:35,784 - lstm_model - INFO - LSTM模型初始化，设备: cuda
2025-05-15 15:26:35,784 - lstm_model - INFO - 模型结构: 输入大小=1, 隐藏大小=64, 层数=2
2025-05-15 15:26:35,784 - lstm_model - INFO - 开始训练LSTM模型，总共20个周期
2025-05-15 15:26:37,616 - lstm_model - INFO - 周期 1/20, 训练损失: 0.002819, 验证损失: 0.001868
2025-05-15 15:26:37,619 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:26:39,199 - lstm_model - INFO - 周期 2/20, 训练损失: 0.001057, 验证损失: 0.001290
2025-05-15 15:26:39,199 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:26:40,815 - lstm_model - INFO - 周期 3/20, 训练损失: 0.000894, 验证损失: 0.001144
2025-05-15 15:26:40,815 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:26:42,432 - lstm_model - INFO - 周期 4/20, 训练损失: 0.000868, 验证损失: 0.001070
2025-05-15 15:26:42,432 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:26:44,032 - lstm_model - INFO - 周期 5/20, 训练损失: 0.000831, 验证损失: 0.001131
2025-05-15 15:26:46,050 - lstm_model - INFO - 周期 6/20, 训练损失: 0.000828, 验证损失: 0.001212
2025-05-15 15:26:48,131 - lstm_model - INFO - 周期 7/20, 训练损失: 0.000827, 验证损失: 0.001094
2025-05-15 15:26:50,209 - lstm_model - INFO - 周期 8/20, 训练损失: 0.000811, 验证损失: 0.001061
2025-05-15 15:26:50,209 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:26:52,021 - lstm_model - INFO - 周期 9/20, 训练损失: 0.000800, 验证损失: 0.001199
2025-05-15 15:26:53,924 - lstm_model - INFO - 周期 10/20, 训练损失: 0.000793, 验证损失: 0.001127
2025-05-15 15:26:55,789 - lstm_model - INFO - 周期 11/20, 训练损失: 0.000809, 验证损失: 0.001133
2025-05-15 15:26:57,795 - lstm_model - INFO - 周期 12/20, 训练损失: 0.000780, 验证损失: 0.001039
2025-05-15 15:26:57,795 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:26:59,743 - lstm_model - INFO - 周期 13/20, 训练损失: 0.000805, 验证损失: 0.001137
2025-05-15 15:27:01,715 - lstm_model - INFO - 周期 14/20, 训练损失: 0.000795, 验证损失: 0.001116
2025-05-15 15:27:03,804 - lstm_model - INFO - 周期 15/20, 训练损失: 0.000785, 验证损失: 0.001121
2025-05-15 15:27:05,697 - lstm_model - INFO - 周期 16/20, 训练损失: 0.000770, 验证损失: 0.001087
2025-05-15 15:27:07,582 - lstm_model - INFO - 周期 17/20, 训练损失: 0.000794, 验证损失: 0.001067
2025-05-15 15:27:09,641 - lstm_model - INFO - 周期 18/20, 训练损失: 0.000754, 验证损失: 0.001147
2025-05-15 15:27:11,841 - lstm_model - INFO - 周期 19/20, 训练损失: 0.000762, 验证损失: 0.001075
2025-05-15 15:27:13,977 - lstm_model - INFO - 周期 20/20, 训练损失: 0.000772, 验证损失: 0.001113
2025-05-15 15:27:14,006 - lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 15:27:14,224 - evaluation - INFO - 模型 LSTM 评估结果:
2025-05-15 15:27:14,224 - evaluation - INFO - RMSE: 8.6626
2025-05-15 15:27:14,224 - evaluation - INFO - MAE: 4.9361
2025-05-15 15:27:14,224 - evaluation - INFO - R²: 0.9572
2025-05-15 15:27:14,224 - evaluation - INFO - MAPE: 11.9010%
2025-05-15 15:27:14,224 - evaluation - INFO - 执行时间: 38.2227 秒
2025-05-15 15:27:14,577 - time_series - INFO - LSTM模型完成，评估结果: RMSE=8.6626, MAE=4.9361
2025-05-15 15:27:14,577 - time_series - INFO - ==================================================
2025-05-15 15:27:14,577 - time_series - INFO - 开始CNN模型训练和预测
2025-05-15 15:27:14,577 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 15:27:14,577 - data_processor - INFO - 训练批次数: 609
2025-05-15 15:27:14,577 - data_processor - INFO - 验证批次数: 87
2025-05-15 15:27:14,577 - data_processor - INFO - 测试批次数: 174
2025-05-15 15:27:14,580 - cnn_model - INFO - CNN模型初始化，设备: cuda
2025-05-15 15:27:14,580 - cnn_model - INFO - 模型结构: 输入通道=1, 序列长度=7
2025-05-15 15:27:14,583 - cnn_model - INFO - 开始训练CNN模型，总共20个周期
2025-05-15 15:27:17,376 - cnn_model - INFO - 周期 1/20, 训练损失: 0.002415, 验证损失: 0.002453
2025-05-15 15:27:17,378 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:19,241 - cnn_model - INFO - 周期 2/20, 训练损失: 0.001166, 验证损失: 0.001799
2025-05-15 15:27:19,243 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:21,082 - cnn_model - INFO - 周期 3/20, 训练损失: 0.001049, 验证损失: 0.001572
2025-05-15 15:27:21,084 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:23,005 - cnn_model - INFO - 周期 4/20, 训练损失: 0.000973, 验证损失: 0.001441
2025-05-15 15:27:23,007 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:24,900 - cnn_model - INFO - 周期 5/20, 训练损失: 0.000951, 验证损失: 0.001639
2025-05-15 15:27:26,681 - cnn_model - INFO - 周期 6/20, 训练损失: 0.000907, 验证损失: 0.001549
2025-05-15 15:27:28,576 - cnn_model - INFO - 周期 7/20, 训练损失: 0.000904, 验证损失: 0.001603
2025-05-15 15:27:30,446 - cnn_model - INFO - 周期 8/20, 训练损失: 0.000876, 验证损失: 0.001363
2025-05-15 15:27:30,450 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:31,997 - cnn_model - INFO - 周期 9/20, 训练损失: 0.000851, 验证损失: 0.001346
2025-05-15 15:27:31,997 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:33,588 - cnn_model - INFO - 周期 10/20, 训练损失: 0.000848, 验证损失: 0.001375
2025-05-15 15:27:35,234 - cnn_model - INFO - 周期 11/20, 训练损失: 0.000829, 验证损失: 0.001257
2025-05-15 15:27:35,236 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:36,757 - cnn_model - INFO - 周期 12/20, 训练损失: 0.000828, 验证损失: 0.001356
2025-05-15 15:27:38,449 - cnn_model - INFO - 周期 13/20, 训练损失: 0.000827, 验证损失: 0.001333
2025-05-15 15:27:39,879 - cnn_model - INFO - 周期 14/20, 训练损失: 0.000796, 验证损失: 0.001383
2025-05-15 15:27:41,582 - cnn_model - INFO - 周期 15/20, 训练损失: 0.000785, 验证损失: 0.001281
2025-05-15 15:27:43,333 - cnn_model - INFO - 周期 16/20, 训练损失: 0.000791, 验证损失: 0.001311
2025-05-15 15:27:45,104 - cnn_model - INFO - 周期 17/20, 训练损失: 0.000784, 验证损失: 0.001298
2025-05-15 15:27:46,730 - cnn_model - INFO - 周期 18/20, 训练损失: 0.000779, 验证损失: 0.001313
2025-05-15 15:27:48,284 - cnn_model - INFO - 周期 19/20, 训练损失: 0.000778, 验证损失: 0.001239
2025-05-15 15:27:48,286 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:49,706 - cnn_model - INFO - 周期 20/20, 训练损失: 0.000763, 验证损失: 0.001238
2025-05-15 15:27:49,706 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:49,713 - cnn_model - INFO - 训练完成，已加载最佳模型
2025-05-15 15:27:49,872 - evaluation - INFO - 模型 CNN 评估结果:
2025-05-15 15:27:49,872 - evaluation - INFO - RMSE: 9.3634
2025-05-15 15:27:49,872 - evaluation - INFO - MAE: 5.7402
2025-05-15 15:27:49,872 - evaluation - INFO - R²: 0.9500
2025-05-15 15:27:49,872 - evaluation - INFO - MAPE: 13.1608%
2025-05-15 15:27:49,872 - evaluation - INFO - 执行时间: 35.1308 秒
2025-05-15 15:27:50,141 - time_series - INFO - CNN模型完成，评估结果: RMSE=9.3634, MAE=5.7402
2025-05-15 15:27:50,141 - time_series - INFO - ==================================================
2025-05-15 15:27:50,141 - time_series - INFO - 开始CNN+LSTM模型训练和预测
2025-05-15 15:27:50,141 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 15:27:50,141 - data_processor - INFO - 训练批次数: 609
2025-05-15 15:27:50,141 - data_processor - INFO - 验证批次数: 87
2025-05-15 15:27:50,141 - data_processor - INFO - 测试批次数: 174
2025-05-15 15:27:50,143 - cnn_lstm_model - INFO - CNN+LSTM模型初始化，设备: cuda
2025-05-15 15:27:50,143 - cnn_lstm_model - INFO - 模型结构: 输入通道=1, 序列长度=7, LSTM隐藏大小=64
2025-05-15 15:27:50,143 - cnn_lstm_model - INFO - 开始训练CNN+LSTM模型，总共20个周期
2025-05-15 15:27:52,045 - cnn_lstm_model - INFO - 周期 1/20, 训练损失: 0.003616, 验证损失: 0.002481
2025-05-15 15:27:52,045 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:54,013 - cnn_lstm_model - INFO - 周期 2/20, 训练损失: 0.001208, 验证损失: 0.001691
2025-05-15 15:27:54,015 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:55,989 - cnn_lstm_model - INFO - 周期 3/20, 训练损失: 0.001059, 验证损失: 0.001512
2025-05-15 15:27:55,989 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:57,944 - cnn_lstm_model - INFO - 周期 4/20, 训练损失: 0.001016, 验证损失: 0.001495
2025-05-15 15:27:57,946 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:27:59,786 - cnn_lstm_model - INFO - 周期 5/20, 训练损失: 0.000960, 验证损失: 0.001629
2025-05-15 15:28:01,603 - cnn_lstm_model - INFO - 周期 6/20, 训练损失: 0.000953, 验证损失: 0.001645
2025-05-15 15:28:03,431 - cnn_lstm_model - INFO - 周期 7/20, 训练损失: 0.000946, 验证损失: 0.001609
2025-05-15 15:28:05,257 - cnn_lstm_model - INFO - 周期 8/20, 训练损失: 0.000945, 验证损失: 0.001446
2025-05-15 15:28:05,257 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:28:07,070 - cnn_lstm_model - INFO - 周期 9/20, 训练损失: 0.000905, 验证损失: 0.001462
2025-05-15 15:28:08,906 - cnn_lstm_model - INFO - 周期 10/20, 训练损失: 0.000908, 验证损失: 0.001419
2025-05-15 15:28:08,906 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:28:10,745 - cnn_lstm_model - INFO - 周期 11/20, 训练损失: 0.000892, 验证损失: 0.001486
2025-05-15 15:28:12,559 - cnn_lstm_model - INFO - 周期 12/20, 训练损失: 0.000876, 验证损失: 0.001316
2025-05-15 15:28:12,559 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:28:14,383 - cnn_lstm_model - INFO - 周期 13/20, 训练损失: 0.000866, 验证损失: 0.001355
2025-05-15 15:28:16,215 - cnn_lstm_model - INFO - 周期 14/20, 训练损失: 0.000863, 验证损失: 0.001354
2025-05-15 15:28:18,052 - cnn_lstm_model - INFO - 周期 15/20, 训练损失: 0.000857, 验证损失: 0.001259
2025-05-15 15:28:18,052 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:28:19,905 - cnn_lstm_model - INFO - 周期 16/20, 训练损失: 0.000829, 验证损失: 0.001449
2025-05-15 15:28:21,730 - cnn_lstm_model - INFO - 周期 17/20, 训练损失: 0.000829, 验证损失: 0.001243
2025-05-15 15:28:21,730 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:28:23,583 - cnn_lstm_model - INFO - 周期 18/20, 训练损失: 0.000839, 验证损失: 0.001351
2025-05-15 15:28:25,387 - cnn_lstm_model - INFO - 周期 19/20, 训练损失: 0.000824, 验证损失: 0.001504
2025-05-15 15:28:27,204 - cnn_lstm_model - INFO - 周期 20/20, 训练损失: 0.000829, 验证损失: 0.001277
2025-05-15 15:28:27,226 - cnn_lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 15:28:27,430 - evaluation - INFO - 模型 CNN+LSTM 评估结果:
2025-05-15 15:28:27,430 - evaluation - INFO - RMSE: 9.7954
2025-05-15 15:28:27,430 - evaluation - INFO - MAE: 6.0053
2025-05-15 15:28:27,430 - evaluation - INFO - R²: 0.9452
2025-05-15 15:28:27,430 - evaluation - INFO - MAPE: 13.7983%
2025-05-15 15:28:27,430 - evaluation - INFO - 执行时间: 37.0825 秒
2025-05-15 15:28:27,635 - time_series - INFO - CNN+LSTM模型完成，评估结果: RMSE=9.7954, MAE=6.0053
2025-05-15 15:28:27,636 - time_series - INFO - ==================================================
2025-05-15 15:28:27,636 - time_series - INFO - 开始Sklearn模型训练和预测
2025-05-15 15:28:27,636 - data_processor - INFO - Sklearn数据准备完成
2025-05-15 15:28:27,636 - data_processor - INFO - 重塑后的训练数据形状: (19464, 7)
2025-05-15 15:28:27,636 - data_processor - INFO - 重塑后的验证数据形状: (2780, 7)
2025-05-15 15:28:27,636 - data_processor - INFO - 重塑后的测试数据形状: (5563, 7)
2025-05-15 15:28:27,637 - sklearn_models - INFO - 初始化Sklearn模型集合
2025-05-15 15:28:27,637 - time_series - INFO - ------------------------------
2025-05-15 15:28:27,637 - time_series - INFO - 训练线性回归模型
2025-05-15 15:28:27,637 - sklearn_models - INFO - 训练线性回归模型
2025-05-15 15:28:27,639 - sklearn_models - INFO - 线性回归模型验证R²得分: 0.8776
2025-05-15 15:28:27,639 - sklearn_models - INFO - 使用 linear_regression 模型进行预测
2025-05-15 15:28:27,645 - evaluation - INFO - 模型 线性回归 评估结果:
2025-05-15 15:28:27,645 - evaluation - INFO - RMSE: 8.8401
2025-05-15 15:28:27,646 - evaluation - INFO - MAE: 5.1610
2025-05-15 15:28:27,646 - evaluation - INFO - R²: 0.9554
2025-05-15 15:28:27,646 - evaluation - INFO - MAPE: 12.8423%
2025-05-15 15:28:27,646 - evaluation - INFO - 执行时间: 0.0016 秒
2025-05-15 15:28:27,846 - time_series - INFO - ------------------------------
2025-05-15 15:28:27,846 - time_series - INFO - 训练决策树模型
2025-05-15 15:28:27,846 - sklearn_models - INFO - 训练决策树模型，参数: {'max_depth': 10, 'random_state': 42}
2025-05-15 15:28:27,903 - sklearn_models - INFO - 决策树模型验证R²得分: 0.8601
2025-05-15 15:28:27,903 - sklearn_models - INFO - 使用 decision_tree 模型进行预测
2025-05-15 15:28:27,903 - evaluation - INFO - 模型 决策树 评估结果:
2025-05-15 15:28:27,903 - evaluation - INFO - RMSE: 9.4953
2025-05-15 15:28:27,903 - evaluation - INFO - MAE: 5.3617
2025-05-15 15:28:27,903 - evaluation - INFO - R²: 0.9485
2025-05-15 15:28:27,903 - evaluation - INFO - MAPE: 12.6134%
2025-05-15 15:28:27,903 - evaluation - INFO - 执行时间: 0.0574 秒
2025-05-15 15:28:28,133 - time_series - INFO - ------------------------------
2025-05-15 15:28:28,133 - time_series - INFO - 训练随机森林模型
2025-05-15 15:28:28,133 - sklearn_models - INFO - 训练随机森林模型，参数: {'n_estimators': 100, 'max_depth': 10, 'random_state': 42}
2025-05-15 15:28:31,954 - sklearn_models - INFO - 随机森林模型验证R²得分: 0.8886
2025-05-15 15:28:31,954 - sklearn_models - INFO - 使用 random_forest 模型进行预测
2025-05-15 15:28:32,004 - evaluation - INFO - 模型 随机森林 评估结果:
2025-05-15 15:28:32,005 - evaluation - INFO - RMSE: 8.7157
2025-05-15 15:28:32,005 - evaluation - INFO - MAE: 4.9895
2025-05-15 15:28:32,005 - evaluation - INFO - R²: 0.9566
2025-05-15 15:28:32,005 - evaluation - INFO - MAPE: 12.2481%
2025-05-15 15:28:32,006 - evaluation - INFO - 执行时间: 3.8210 秒
2025-05-15 15:28:32,205 - time_series - INFO - ------------------------------
2025-05-15 15:28:32,205 - time_series - INFO - 训练XGBoost模型
2025-05-15 15:28:32,205 - sklearn_models - INFO - 训练XGBoost模型，参数: {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'objective': 'reg:squarederror', 'random_state': 42}
2025-05-15 15:28:32,375 - sklearn_models - INFO - XGBoost模型验证R²得分: 0.8776
2025-05-15 15:28:32,375 - sklearn_models - INFO - 使用 xgboost 模型进行预测
2025-05-15 15:28:32,375 - evaluation - INFO - 模型 XGBoost 评估结果:
2025-05-15 15:28:32,375 - evaluation - INFO - RMSE: 8.7086
2025-05-15 15:28:32,375 - evaluation - INFO - MAE: 4.9935
2025-05-15 15:28:32,375 - evaluation - INFO - R²: 0.9567
2025-05-15 15:28:32,375 - evaluation - INFO - MAPE: 12.2249%
2025-05-15 15:28:32,375 - evaluation - INFO - 执行时间: 0.1699 秒
2025-05-15 15:28:32,618 - time_series - INFO - 所有Sklearn模型训练完成
2025-05-15 15:28:33,338 - time_series - INFO - 所有结果已保存到 time_series/results\all_models_comparison.xlsx
2025-05-15 15:28:33,338 - time_series - INFO - 时间序列预测系统运行完成
