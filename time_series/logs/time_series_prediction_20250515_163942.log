2025-05-15 16:39:42,019 - time_series - INFO - 开始运行时间序列预测系统
2025-05-15 16:39:42,019 - time_series - INFO - 日志文件: time_series/logs\time_series_prediction_20250515_163942.log
2025-05-15 16:39:42,019 - data_utils - INFO - 正在加载数据集: time_series\北京-逐日.xlsx
2025-05-15 16:39:43,408 - data_utils - INFO - 数据集加载成功，形状: (27814, 3)
2025-05-15 16:39:43,408 - data_utils - INFO - 提取的AQI数据形状: (27814,)
2025-05-15 16:39:43,427 - data_utils - INFO - 创建的序列形状: X=(27807, 7), y=(27807,)
2025-05-15 16:39:43,430 - data_utils - INFO - 训练集形状: X=(19464, 7), y=(19464,)
2025-05-15 16:39:43,430 - data_utils - INFO - 验证集形状: X=(2780, 7), y=(2780,)
2025-05-15 16:39:43,433 - data_utils - INFO - 测试集形状: X=(5563, 7), y=(5563,)
2025-05-15 16:39:43,433 - data_processor - INFO - 数据处理器初始化，序列长度: 7, 批次大小: 32
2025-05-15 16:39:43,433 - time_series - INFO - ==================================================
2025-05-15 16:39:43,433 - time_series - INFO - 开始LSTM模型训练和预测
2025-05-15 16:39:43,435 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:39:43,435 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:39:43,435 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:39:43,435 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:39:45,981 - lstm_model - INFO - LSTM模型初始化，设备: cuda
2025-05-15 16:39:45,981 - lstm_model - INFO - 模型结构: 输入大小=1, 隐藏大小=64, 层数=2
2025-05-15 16:39:45,982 - lstm_model - INFO - 开始训练LSTM模型，总共20个周期
2025-05-15 16:39:47,984 - lstm_model - INFO - 周期 1/20, 训练损失: 0.002611, 验证损失: 0.002054
2025-05-15 16:39:47,986 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:39:49,807 - lstm_model - INFO - 周期 2/20, 训练损失: 0.001120, 验证损失: 0.001170
2025-05-15 16:39:49,811 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:39:52,552 - lstm_model - INFO - 周期 3/20, 训练损失: 0.000924, 验证损失: 0.001173
2025-05-15 16:39:54,599 - lstm_model - INFO - 周期 4/20, 训练损失: 0.000864, 验证损失: 0.001173
2025-05-15 16:39:56,316 - lstm_model - INFO - 周期 5/20, 训练损失: 0.000839, 验证损失: 0.001131
2025-05-15 16:39:56,317 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:39:58,101 - lstm_model - INFO - 周期 6/20, 训练损失: 0.000854, 验证损失: 0.001198
2025-05-15 16:39:59,841 - lstm_model - INFO - 周期 7/20, 训练损失: 0.000804, 验证损失: 0.001070
2025-05-15 16:39:59,843 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:01,598 - lstm_model - INFO - 周期 8/20, 训练损失: 0.000776, 验证损失: 0.001031
2025-05-15 16:40:01,601 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:03,662 - lstm_model - INFO - 周期 9/20, 训练损失: 0.000822, 验证损失: 0.001145
2025-05-15 16:40:05,696 - lstm_model - INFO - 周期 10/20, 训练损失: 0.000786, 验证损失: 0.001072
2025-05-15 16:40:07,611 - lstm_model - INFO - 周期 11/20, 训练损失: 0.000790, 验证损失: 0.001152
2025-05-15 16:40:09,515 - lstm_model - INFO - 周期 12/20, 训练损失: 0.000818, 验证损失: 0.001204
2025-05-15 16:40:11,274 - lstm_model - INFO - 周期 13/20, 训练损失: 0.000787, 验证损失: 0.001141
2025-05-15 16:40:13,014 - lstm_model - INFO - 周期 14/20, 训练损失: 0.000775, 验证损失: 0.001205
2025-05-15 16:40:14,835 - lstm_model - INFO - 周期 15/20, 训练损失: 0.000772, 验证损失: 0.001056
2025-05-15 16:40:16,524 - lstm_model - INFO - 周期 16/20, 训练损失: 0.000758, 验证损失: 0.001157
2025-05-15 16:40:18,224 - lstm_model - INFO - 周期 17/20, 训练损失: 0.000781, 验证损失: 0.001083
2025-05-15 16:40:19,890 - lstm_model - INFO - 周期 18/20, 训练损失: 0.000768, 验证损失: 0.001081
2025-05-15 16:40:19,890 - lstm_model - INFO - 早停触发，10个周期内验证损失未改善
2025-05-15 16:40:19,910 - lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:40:20,086 - evaluation - INFO - 模型 LSTM 评估结果:
2025-05-15 16:40:20,100 - evaluation - INFO - RMSE: 9.0225
2025-05-15 16:40:20,100 - evaluation - INFO - MAE: 5.7556
2025-05-15 16:40:20,100 - evaluation - INFO - R²: 0.9535
2025-05-15 16:40:20,100 - evaluation - INFO - MAPE: 16.1661%
2025-05-15 16:40:20,100 - evaluation - INFO - 执行时间: 33.9292 秒
2025-05-15 16:40:20,429 - time_series - INFO - LSTM模型完成，评估结果: RMSE=9.0225, MAE=5.7556
2025-05-15 16:40:20,430 - time_series - INFO - ==================================================
2025-05-15 16:40:20,430 - time_series - INFO - 开始CNN模型训练和预测
2025-05-15 16:40:20,430 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:40:20,430 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:40:20,432 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:40:20,432 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:40:20,432 - cnn_model - INFO - CNN模型初始化，设备: cuda
2025-05-15 16:40:20,432 - cnn_model - INFO - 模型结构: 输入通道=1, 序列长度=7
2025-05-15 16:40:20,432 - cnn_model - INFO - 开始训练CNN模型，总共20个周期
2025-05-15 16:40:22,732 - cnn_model - INFO - 周期 1/20, 训练损失: 0.002256, 验证损失: 0.002461
2025-05-15 16:40:22,740 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:24,164 - cnn_model - INFO - 周期 2/20, 训练损失: 0.001175, 验证损失: 0.001831
2025-05-15 16:40:24,166 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:25,591 - cnn_model - INFO - 周期 3/20, 训练损失: 0.001027, 验证损失: 0.001566
2025-05-15 16:40:25,591 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:27,023 - cnn_model - INFO - 周期 4/20, 训练损失: 0.000979, 验证损失: 0.001506
2025-05-15 16:40:27,030 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:28,625 - cnn_model - INFO - 周期 5/20, 训练损失: 0.000950, 验证损失: 0.001516
2025-05-15 16:40:30,452 - cnn_model - INFO - 周期 6/20, 训练损失: 0.000936, 验证损失: 0.001459
2025-05-15 16:40:30,453 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:32,009 - cnn_model - INFO - 周期 7/20, 训练损失: 0.000908, 验证损失: 0.001480
2025-05-15 16:40:34,323 - cnn_model - INFO - 周期 8/20, 训练损失: 0.000886, 验证损失: 0.001389
2025-05-15 16:40:34,325 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:36,478 - cnn_model - INFO - 周期 9/20, 训练损失: 0.000877, 验证损失: 0.001505
2025-05-15 16:40:38,530 - cnn_model - INFO - 周期 10/20, 训练损失: 0.000873, 验证损失: 0.001404
2025-05-15 16:40:40,278 - cnn_model - INFO - 周期 11/20, 训练损失: 0.000844, 验证损失: 0.001339
2025-05-15 16:40:40,281 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:41,984 - cnn_model - INFO - 周期 12/20, 训练损失: 0.000850, 验证损失: 0.001332
2025-05-15 16:40:41,984 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:43,633 - cnn_model - INFO - 周期 13/20, 训练损失: 0.000838, 验证损失: 0.001335
2025-05-15 16:40:45,290 - cnn_model - INFO - 周期 14/20, 训练损失: 0.000852, 验证损失: 0.001403
2025-05-15 16:40:47,234 - cnn_model - INFO - 周期 15/20, 训练损失: 0.000827, 验证损失: 0.001383
2025-05-15 16:40:49,049 - cnn_model - INFO - 周期 16/20, 训练损失: 0.000822, 验证损失: 0.001334
2025-05-15 16:40:50,923 - cnn_model - INFO - 周期 17/20, 训练损失: 0.000817, 验证损失: 0.001330
2025-05-15 16:40:50,933 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:52,634 - cnn_model - INFO - 周期 18/20, 训练损失: 0.000823, 验证损失: 0.001281
2025-05-15 16:40:52,634 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:40:54,514 - cnn_model - INFO - 周期 19/20, 训练损失: 0.000810, 验证损失: 0.001314
2025-05-15 16:40:56,323 - cnn_model - INFO - 周期 20/20, 训练损失: 0.000804, 验证损失: 0.001359
2025-05-15 16:40:56,341 - cnn_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:40:56,511 - evaluation - INFO - 模型 CNN 评估结果:
2025-05-15 16:40:56,511 - evaluation - INFO - RMSE: 9.4332
2025-05-15 16:40:56,511 - evaluation - INFO - MAE: 5.8560
2025-05-15 16:40:56,511 - evaluation - INFO - R²: 0.9492
2025-05-15 16:40:56,511 - evaluation - INFO - MAPE: 15.1360%
2025-05-15 16:40:56,511 - evaluation - INFO - 执行时间: 35.9094 秒
2025-05-15 16:40:56,806 - time_series - INFO - CNN模型完成，评估结果: RMSE=9.4332, MAE=5.8560
2025-05-15 16:40:56,806 - time_series - INFO - ==================================================
2025-05-15 16:40:56,806 - time_series - INFO - 开始CNN+LSTM模型训练和预测
2025-05-15 16:40:56,806 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:40:56,806 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:40:56,809 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:40:56,809 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:40:56,811 - cnn_lstm_model - INFO - CNN+LSTM模型初始化，设备: cuda
2025-05-15 16:40:56,811 - cnn_lstm_model - INFO - 模型结构: 输入通道=1, 序列长度=7, LSTM隐藏大小=64
2025-05-15 16:40:56,811 - cnn_lstm_model - INFO - 开始训练CNN+LSTM模型，总共20个周期
2025-05-15 16:40:58,981 - cnn_lstm_model - INFO - 周期 1/20, 训练损失: 0.002896, 验证损失: 0.002132
2025-05-15 16:40:58,981 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:01,102 - cnn_lstm_model - INFO - 周期 2/20, 训练损失: 0.001153, 验证损失: 0.001924
2025-05-15 16:41:01,102 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:03,331 - cnn_lstm_model - INFO - 周期 3/20, 训练损失: 0.001044, 验证损失: 0.001619
2025-05-15 16:41:03,331 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:05,531 - cnn_lstm_model - INFO - 周期 4/20, 训练损失: 0.001004, 验证损失: 0.001659
2025-05-15 16:41:07,689 - cnn_lstm_model - INFO - 周期 5/20, 训练损失: 0.000966, 验证损失: 0.001514
2025-05-15 16:41:07,691 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:10,036 - cnn_lstm_model - INFO - 周期 6/20, 训练损失: 0.000949, 验证损失: 0.001501
2025-05-15 16:41:10,037 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:12,389 - cnn_lstm_model - INFO - 周期 7/20, 训练损失: 0.000922, 验证损失: 0.001426
2025-05-15 16:41:12,393 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:14,454 - cnn_lstm_model - INFO - 周期 8/20, 训练损失: 0.000901, 验证损失: 0.001397
2025-05-15 16:41:14,454 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:16,684 - cnn_lstm_model - INFO - 周期 9/20, 训练损失: 0.000905, 验证损失: 0.001491
2025-05-15 16:41:18,889 - cnn_lstm_model - INFO - 周期 10/20, 训练损失: 0.000866, 验证损失: 0.001345
2025-05-15 16:41:18,900 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:21,028 - cnn_lstm_model - INFO - 周期 11/20, 训练损失: 0.000863, 验证损失: 0.001367
2025-05-15 16:41:23,293 - cnn_lstm_model - INFO - 周期 12/20, 训练损失: 0.000848, 验证损失: 0.001272
2025-05-15 16:41:23,293 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:25,398 - cnn_lstm_model - INFO - 周期 13/20, 训练损失: 0.000836, 验证损失: 0.001253
2025-05-15 16:41:25,405 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:27,834 - cnn_lstm_model - INFO - 周期 14/20, 训练损失: 0.000815, 验证损失: 0.001256
2025-05-15 16:41:29,919 - cnn_lstm_model - INFO - 周期 15/20, 训练损失: 0.000814, 验证损失: 0.001327
2025-05-15 16:41:32,014 - cnn_lstm_model - INFO - 周期 16/20, 训练损失: 0.000807, 验证损失: 0.001287
2025-05-15 16:41:33,955 - cnn_lstm_model - INFO - 周期 17/20, 训练损失: 0.000815, 验证损失: 0.001284
2025-05-15 16:41:35,997 - cnn_lstm_model - INFO - 周期 18/20, 训练损失: 0.000803, 验证损失: 0.001561
2025-05-15 16:41:37,959 - cnn_lstm_model - INFO - 周期 19/20, 训练损失: 0.000795, 验证损失: 0.001228
2025-05-15 16:41:37,959 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:41:39,972 - cnn_lstm_model - INFO - 周期 20/20, 训练损失: 0.000787, 验证损失: 0.001286
2025-05-15 16:41:39,989 - cnn_lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:41:40,219 - evaluation - INFO - 模型 CNN+LSTM 评估结果:
2025-05-15 16:41:40,219 - evaluation - INFO - RMSE: 10.1406
2025-05-15 16:41:40,219 - evaluation - INFO - MAE: 6.7367
2025-05-15 16:41:40,219 - evaluation - INFO - R²: 0.9413
2025-05-15 16:41:40,219 - evaluation - INFO - MAPE: 19.6522%
2025-05-15 16:41:40,219 - evaluation - INFO - 执行时间: 43.1779 秒
2025-05-15 16:41:40,489 - time_series - INFO - CNN+LSTM模型完成，评估结果: RMSE=10.1406, MAE=6.7367
2025-05-15 16:41:40,489 - time_series - INFO - ==================================================
2025-05-15 16:41:40,489 - time_series - INFO - 开始Sklearn模型训练和预测
2025-05-15 16:41:40,489 - data_processor - INFO - Sklearn数据准备完成
2025-05-15 16:41:40,490 - data_processor - INFO - 重塑后的训练数据形状: (19464, 7)
2025-05-15 16:41:40,490 - data_processor - INFO - 重塑后的验证数据形状: (2780, 7)
2025-05-15 16:41:40,490 - data_processor - INFO - 重塑后的测试数据形状: (5563, 7)
2025-05-15 16:41:40,490 - sklearn_models - INFO - 初始化Sklearn模型集合
2025-05-15 16:41:40,491 - time_series - INFO - ------------------------------
2025-05-15 16:41:40,491 - time_series - INFO - 训练线性回归模型
2025-05-15 16:41:40,491 - sklearn_models - INFO - 训练线性回归模型
2025-05-15 16:41:40,500 - sklearn_models - INFO - 线性回归模型验证R²得分: 0.8776
2025-05-15 16:41:40,500 - sklearn_models - INFO - 使用 linear_regression 模型进行预测
2025-05-15 16:41:40,512 - evaluation - INFO - 模型 线性回归 评估结果:
2025-05-15 16:41:40,512 - evaluation - INFO - RMSE: 8.8401
2025-05-15 16:41:40,512 - evaluation - INFO - MAE: 5.1610
2025-05-15 16:41:40,513 - evaluation - INFO - R²: 0.9554
2025-05-15 16:41:40,513 - evaluation - INFO - MAPE: 12.8423%
2025-05-15 16:41:40,513 - evaluation - INFO - 执行时间: 0.0088 秒
2025-05-15 16:41:40,865 - time_series - INFO - ------------------------------
2025-05-15 16:41:40,865 - time_series - INFO - 训练决策树模型
2025-05-15 16:41:40,865 - sklearn_models - INFO - 训练决策树模型，参数: {'max_depth': 10, 'random_state': 42}
2025-05-15 16:41:40,939 - sklearn_models - INFO - 决策树模型验证R²得分: 0.8601
2025-05-15 16:41:40,939 - sklearn_models - INFO - 使用 decision_tree 模型进行预测
2025-05-15 16:41:40,947 - evaluation - INFO - 模型 决策树 评估结果:
2025-05-15 16:41:40,947 - evaluation - INFO - RMSE: 9.4953
2025-05-15 16:41:40,947 - evaluation - INFO - MAE: 5.3617
2025-05-15 16:41:40,947 - evaluation - INFO - R²: 0.9485
2025-05-15 16:41:40,947 - evaluation - INFO - MAPE: 12.6134%
2025-05-15 16:41:40,947 - evaluation - INFO - 执行时间: 0.0742 秒
2025-05-15 16:41:41,217 - time_series - INFO - ------------------------------
2025-05-15 16:41:41,217 - time_series - INFO - 训练随机森林模型
2025-05-15 16:41:41,217 - sklearn_models - INFO - 训练随机森林模型，参数: {'n_estimators': 100, 'max_depth': 10, 'random_state': 42}
2025-05-15 16:41:45,447 - sklearn_models - INFO - 随机森林模型验证R²得分: 0.8886
2025-05-15 16:41:45,447 - sklearn_models - INFO - 使用 random_forest 模型进行预测
2025-05-15 16:41:45,494 - evaluation - INFO - 模型 随机森林 评估结果:
2025-05-15 16:41:45,494 - evaluation - INFO - RMSE: 8.7157
2025-05-15 16:41:45,495 - evaluation - INFO - MAE: 4.9895
2025-05-15 16:41:45,495 - evaluation - INFO - R²: 0.9566
2025-05-15 16:41:45,495 - evaluation - INFO - MAPE: 12.2481%
2025-05-15 16:41:45,495 - evaluation - INFO - 执行时间: 4.2300 秒
2025-05-15 16:41:45,751 - time_series - INFO - ------------------------------
2025-05-15 16:41:45,751 - time_series - INFO - 训练XGBoost模型
2025-05-15 16:41:45,751 - sklearn_models - INFO - 训练XGBoost模型，参数: {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'objective': 'reg:squarederror', 'random_state': 42}
2025-05-15 16:41:45,986 - sklearn_models - INFO - XGBoost模型验证R²得分: 0.8776
2025-05-15 16:41:45,986 - sklearn_models - INFO - 使用 xgboost 模型进行预测
2025-05-15 16:41:45,995 - evaluation - INFO - 模型 XGBoost 评估结果:
2025-05-15 16:41:45,995 - evaluation - INFO - RMSE: 8.7086
2025-05-15 16:41:45,995 - evaluation - INFO - MAE: 4.9935
2025-05-15 16:41:45,995 - evaluation - INFO - R²: 0.9567
2025-05-15 16:41:45,995 - evaluation - INFO - MAPE: 12.2249%
2025-05-15 16:41:45,999 - evaluation - INFO - 执行时间: 0.2348 秒
2025-05-15 16:41:46,306 - time_series - INFO - ------------------------------
2025-05-15 16:41:46,306 - time_series - INFO - 训练SVM模型
2025-05-15 16:41:46,306 - sklearn_models - INFO - 训练SVM模型，参数: {'kernel': 'rbf', 'C': 1.0, 'epsilon': 0.1}
2025-05-15 16:41:46,820 - sklearn_models - INFO - SVM模型验证R²得分: 0.7728
2025-05-15 16:41:46,820 - sklearn_models - INFO - 使用 svm 模型进行预测
2025-05-15 16:41:46,937 - evaluation - INFO - 模型 SVM 评估结果:
2025-05-15 16:41:46,937 - evaluation - INFO - RMSE: 21.3378
2025-05-15 16:41:46,937 - evaluation - INFO - MAE: 18.0252
2025-05-15 16:41:46,937 - evaluation - INFO - R²: 0.7402
2025-05-15 16:41:46,937 - evaluation - INFO - MAPE: 67.9728%
2025-05-15 16:41:46,937 - evaluation - INFO - 执行时间: 0.5143 秒
2025-05-15 16:41:47,197 - time_series - INFO - ------------------------------
2025-05-15 16:41:47,197 - time_series - INFO - 训练梯度提升树模型
2025-05-15 16:41:47,197 - sklearn_models - INFO - 训练Gradient Boosting模型，参数: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': 3, 'random_state': 42}
2025-05-15 16:41:49,173 - sklearn_models - INFO - Gradient Boosting模型验证R²得分: 0.8632
2025-05-15 16:41:49,173 - sklearn_models - INFO - 使用 gradient_boosting 模型进行预测
2025-05-15 16:41:49,181 - evaluation - INFO - 模型 梯度提升树 评估结果:
2025-05-15 16:41:49,181 - evaluation - INFO - RMSE: 8.7235
2025-05-15 16:41:49,181 - evaluation - INFO - MAE: 5.1766
2025-05-15 16:41:49,181 - evaluation - INFO - R²: 0.9566
2025-05-15 16:41:49,181 - evaluation - INFO - MAPE: 13.0284%
2025-05-15 16:41:49,183 - evaluation - INFO - 执行时间: 1.9765 秒
2025-05-15 16:41:49,439 - time_series - INFO - ------------------------------
2025-05-15 16:41:49,439 - time_series - INFO - 训练LightGBM模型
2025-05-15 16:41:49,439 - sklearn_models - INFO - 训练LightGBM模型，参数: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'random_state': 42, 'verbose': -1}
2025-05-15 16:41:49,635 - sklearn_models - INFO - LightGBM模型验证R²得分: 0.8872
2025-05-15 16:41:49,635 - sklearn_models - INFO - 使用 lightgbm 模型进行预测
2025-05-15 16:41:49,655 - evaluation - INFO - 模型 LightGBM 评估结果:
2025-05-15 16:41:49,655 - evaluation - INFO - RMSE: 8.8139
2025-05-15 16:41:49,656 - evaluation - INFO - MAE: 5.0413
2025-05-15 16:41:49,656 - evaluation - INFO - R²: 0.9557
2025-05-15 16:41:49,657 - evaluation - INFO - MAPE: 12.3964%
2025-05-15 16:41:49,657 - evaluation - INFO - 执行时间: 0.1953 秒
2025-05-15 16:41:49,956 - time_series - INFO - ------------------------------
2025-05-15 16:41:49,956 - time_series - INFO - 训练CatBoost模型
2025-05-15 16:41:49,958 - sklearn_models - INFO - 训练CatBoost模型，参数: {'iterations': 100, 'learning_rate': 0.1, 'depth': 6, 'random_state': 42, 'verbose': 0}
2025-05-15 16:41:50,845 - sklearn_models - INFO - CatBoost模型验证R²得分: 0.8789
2025-05-15 16:41:50,845 - sklearn_models - INFO - 使用 catboost 模型进行预测
2025-05-15 16:41:50,859 - evaluation - INFO - 模型 CatBoost 评估结果:
2025-05-15 16:41:50,859 - evaluation - INFO - RMSE: 8.9734
2025-05-15 16:41:50,859 - evaluation - INFO - MAE: 5.3235
2025-05-15 16:41:50,859 - evaluation - INFO - R²: 0.9540
2025-05-15 16:41:50,859 - evaluation - INFO - MAPE: 13.4418%
2025-05-15 16:41:50,859 - evaluation - INFO - 执行时间: 0.8876 秒
2025-05-15 16:41:51,113 - time_series - INFO - 所有Sklearn模型训练完成
2025-05-15 16:41:51,115 - time_series - INFO - ==================================================
2025-05-15 16:41:51,115 - time_series - INFO - 开始ARIMA模型训练和预测
2025-05-15 16:41:51,115 - time_series - ERROR - 运行ARIMA模型时发生错误: 'TimeSeriesDataProcessor' object has no attribute 'data_dict'
2025-05-15 16:41:51,116 - time_series - INFO - ==================================================
2025-05-15 16:41:51,116 - time_series - INFO - 开始Prophet模型训练和预测
2025-05-15 16:41:51,117 - time_series - WARNING - Prophet模型：未找到明确的 '日期' 列，将尝试使用索引生成日期。
2025-05-15 16:41:51,117 - time_series - INFO - Prophet模型：将使用第一列 'date' 作为日期列。
2025-05-15 16:41:51,137 - time_series - ERROR - 运行Prophet模型时发生错误: 'TimeSeriesDataProcessor' object has no attribute 'data_dict'
2025-05-15 16:41:51,138 - time_series - INFO - ==================================================
2025-05-15 16:41:51,138 - time_series - INFO - 开始Transformer模型训练和预测
2025-05-15 16:41:51,138 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:41:51,138 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:41:51,139 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:41:51,139 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:41:51,181 - transformer_model - INFO - TransformerModel initialized on cuda
2025-05-15 16:41:51,181 - transformer_model - INFO - Model params: input_size=1, d_model=64, nhead=4, layers=2, ff_dim=128, output_size=1, seq_len=7
2025-05-15 16:41:51,181 - transformer_model - INFO - Starting Transformer training for 20 epochs.
2025-05-15 16:41:56,895 - transformer_model - INFO - Epoch 1/20, Train Loss: 0.0139, Val Loss: 0.0086
2025-05-15 16:41:56,895 - transformer_model - INFO - New best validation loss: 0.0086. Saving model state.
2025-05-15 16:42:02,115 - transformer_model - INFO - Epoch 2/20, Train Loss: 0.0115, Val Loss: 0.0094
2025-05-15 16:42:07,429 - transformer_model - INFO - Epoch 3/20, Train Loss: 0.0114, Val Loss: 0.0088
2025-05-15 16:42:12,979 - transformer_model - INFO - Epoch 4/20, Train Loss: 0.0112, Val Loss: 0.0092
2025-05-15 16:42:18,471 - transformer_model - INFO - Epoch 5/20, Train Loss: 0.0112, Val Loss: 0.0089
2025-05-15 16:42:23,691 - transformer_model - INFO - Epoch 6/20, Train Loss: 0.0112, Val Loss: 0.0090
2025-05-15 16:42:29,252 - transformer_model - INFO - Epoch 7/20, Train Loss: 0.0112, Val Loss: 0.0088
2025-05-15 16:42:35,312 - transformer_model - INFO - Epoch 8/20, Train Loss: 0.0112, Val Loss: 0.0091
2025-05-15 16:42:42,113 - transformer_model - INFO - Epoch 9/20, Train Loss: 0.0112, Val Loss: 0.0091
2025-05-15 16:42:48,544 - transformer_model - INFO - Epoch 10/20, Train Loss: 0.0112, Val Loss: 0.0086
2025-05-15 16:42:54,915 - transformer_model - INFO - Epoch 11/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:42:54,916 - transformer_model - INFO - New best validation loss: 0.0086. Saving model state.
2025-05-15 16:43:02,495 - transformer_model - INFO - Epoch 12/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:43:09,698 - transformer_model - INFO - Epoch 13/20, Train Loss: 0.0112, Val Loss: 0.0087
2025-05-15 16:43:16,451 - transformer_model - INFO - Epoch 14/20, Train Loss: 0.0111, Val Loss: 0.0090
2025-05-15 16:43:25,506 - transformer_model - INFO - Epoch 15/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:43:33,748 - transformer_model - INFO - Epoch 16/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:43:42,961 - transformer_model - INFO - Epoch 17/20, Train Loss: 0.0111, Val Loss: 0.0090
2025-05-15 16:43:49,676 - transformer_model - INFO - Epoch 18/20, Train Loss: 0.0111, Val Loss: 0.0090
2025-05-15 16:43:55,793 - transformer_model - INFO - Epoch 19/20, Train Loss: 0.0111, Val Loss: 0.0089
2025-05-15 16:44:01,725 - transformer_model - INFO - Epoch 20/20, Train Loss: 0.0111, Val Loss: 0.0090
2025-05-15 16:44:01,725 - transformer_model - INFO - Loaded best model state for Transformer.
2025-05-15 16:44:02,053 - evaluation - INFO - 模型 Transformer 评估结果:
2025-05-15 16:44:02,053 - evaluation - INFO - RMSE: 43.1554
2025-05-15 16:44:02,053 - evaluation - INFO - MAE: 34.1620
2025-05-15 16:44:02,053 - evaluation - INFO - R²: -0.0629
2025-05-15 16:44:02,053 - evaluation - INFO - MAPE: 105.4110%
2025-05-15 16:44:02,053 - evaluation - INFO - 执行时间: 130.5448 秒
2025-05-15 16:44:02,310 - time_series - INFO - Transformer模型完成，评估结果: RMSE=43.1554, MAE=34.1620, R2=-0.0629
2025-05-15 16:44:02,310 - time_series - INFO - ==================================================
2025-05-15 16:44:02,310 - time_series - INFO - 开始CNN-LSTM-Attention模型训练和预测
2025-05-15 16:44:02,310 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:44:02,310 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:44:02,317 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:44:02,317 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:44:02,320 - cnn_lstm_attention_model - INFO - CNNLSTMAttentionModel initialized on cuda
2025-05-15 16:44:02,321 - cnn_lstm_attention_model - INFO - Model params: input_channels=1, seq_length=7, lstm_hidden=64, cnn_out=32
2025-05-15 16:44:02,321 - cnn_lstm_attention_model - INFO - Starting CNN-LSTM-Attention training for 20 epochs.
2025-05-15 16:44:05,128 - cnn_lstm_attention_model - INFO - Epoch 1/20, Train Loss: 0.0111, Val Loss: 0.0092
2025-05-15 16:44:05,130 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0092. Saving model state.
2025-05-15 16:44:07,834 - cnn_lstm_attention_model - INFO - Epoch 2/20, Train Loss: 0.0111, Val Loss: 0.0085
2025-05-15 16:44:07,834 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0085. Saving model state.
2025-05-15 16:44:10,253 - cnn_lstm_attention_model - INFO - Epoch 3/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:12,710 - cnn_lstm_attention_model - INFO - Epoch 4/20, Train Loss: 0.0111, Val Loss: 0.0089
2025-05-15 16:44:15,282 - cnn_lstm_attention_model - INFO - Epoch 5/20, Train Loss: 0.0111, Val Loss: 0.0089
2025-05-15 16:44:17,747 - cnn_lstm_attention_model - INFO - Epoch 6/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:20,188 - cnn_lstm_attention_model - INFO - Epoch 7/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:44:22,498 - cnn_lstm_attention_model - INFO - Epoch 8/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:24,780 - cnn_lstm_attention_model - INFO - Epoch 9/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:27,184 - cnn_lstm_attention_model - INFO - Epoch 10/20, Train Loss: 0.0111, Val Loss: 0.0094
2025-05-15 16:44:29,608 - cnn_lstm_attention_model - INFO - Epoch 11/20, Train Loss: 0.0112, Val Loss: 0.0087
2025-05-15 16:44:31,894 - cnn_lstm_attention_model - INFO - Epoch 12/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:44:34,171 - cnn_lstm_attention_model - INFO - Epoch 13/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:36,619 - cnn_lstm_attention_model - INFO - Epoch 14/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:44:39,061 - cnn_lstm_attention_model - INFO - Epoch 15/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:41,884 - cnn_lstm_attention_model - INFO - Epoch 16/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:44,548 - cnn_lstm_attention_model - INFO - Epoch 17/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:44:46,877 - cnn_lstm_attention_model - INFO - Epoch 18/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:44:49,281 - cnn_lstm_attention_model - INFO - Epoch 19/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:51,666 - cnn_lstm_attention_model - INFO - Epoch 20/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:44:51,666 - cnn_lstm_attention_model - INFO - Loaded best model state for CNN-LSTM-Attention.
2025-05-15 16:44:51,912 - evaluation - INFO - 模型 CNN-LSTM-Attention 评估结果:
2025-05-15 16:44:51,912 - evaluation - INFO - RMSE: 42.7040
2025-05-15 16:44:51,912 - evaluation - INFO - MAE: 34.3599
2025-05-15 16:44:51,912 - evaluation - INFO - R²: -0.0408
2025-05-15 16:44:51,913 - evaluation - INFO - MAPE: 107.7997%
2025-05-15 16:44:51,913 - evaluation - INFO - 执行时间: 49.3452 秒
2025-05-15 16:44:52,143 - time_series - INFO - CNN-LSTM-Attention模型完成，评估结果: RMSE=42.7040, MAE=34.3599, R2=-0.0408
2025-05-15 16:44:52,726 - time_series - INFO - 所有有效结果已保存到 time_series/results\all_models_comparison.xlsx
2025-05-15 16:44:52,727 - time_series - INFO - 时间序列预测系统运行完成
