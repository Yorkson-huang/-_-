2025-05-15 16:34:43,639 - time_series - INFO - 开始运行时间序列预测系统
2025-05-15 16:34:43,639 - time_series - INFO - 日志文件: time_series/logs\time_series_prediction_20250515_163443.log
2025-05-15 16:34:43,639 - data_utils - INFO - 正在加载数据集: time_series\北京-逐日.xlsx
2025-05-15 16:34:45,091 - data_utils - INFO - 数据集加载成功，形状: (27814, 3)
2025-05-15 16:34:45,091 - data_utils - INFO - 提取的AQI数据形状: (27814,)
2025-05-15 16:34:45,116 - data_utils - INFO - 创建的序列形状: X=(27807, 7), y=(27807,)
2025-05-15 16:34:45,116 - data_utils - INFO - 训练集形状: X=(19464, 7), y=(19464,)
2025-05-15 16:34:45,116 - data_utils - INFO - 验证集形状: X=(2780, 7), y=(2780,)
2025-05-15 16:34:45,119 - data_utils - INFO - 测试集形状: X=(5563, 7), y=(5563,)
2025-05-15 16:34:45,121 - data_processor - INFO - 数据处理器初始化，序列长度: 7, 批次大小: 32
2025-05-15 16:34:45,121 - time_series - INFO - ==================================================
2025-05-15 16:34:45,121 - time_series - INFO - 开始LSTM模型训练和预测
2025-05-15 16:34:45,125 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:34:45,125 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:34:45,125 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:34:45,125 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:34:48,327 - lstm_model - INFO - LSTM模型初始化，设备: cuda
2025-05-15 16:34:48,327 - lstm_model - INFO - 模型结构: 输入大小=1, 隐藏大小=64, 层数=2
2025-05-15 16:34:48,327 - lstm_model - INFO - 开始训练LSTM模型，总共20个周期
2025-05-15 16:34:50,427 - lstm_model - INFO - 周期 1/20, 训练损失: 0.002693, 验证损失: 0.001776
2025-05-15 16:34:50,432 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:34:52,278 - lstm_model - INFO - 周期 2/20, 训练损失: 0.001138, 验证损失: 0.001256
2025-05-15 16:34:52,278 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:34:54,273 - lstm_model - INFO - 周期 3/20, 训练损失: 0.000946, 验证损失: 0.001163
2025-05-15 16:34:54,274 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:34:56,132 - lstm_model - INFO - 周期 4/20, 训练损失: 0.000864, 验证损失: 0.001312
2025-05-15 16:34:57,958 - lstm_model - INFO - 周期 5/20, 训练损失: 0.000816, 验证损失: 0.001118
2025-05-15 16:34:57,966 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:34:59,932 - lstm_model - INFO - 周期 6/20, 训练损失: 0.000817, 验证损失: 0.001097
2025-05-15 16:34:59,932 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:35:01,790 - lstm_model - INFO - 周期 7/20, 训练损失: 0.000819, 验证损失: 0.001069
2025-05-15 16:35:01,796 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:35:03,680 - lstm_model - INFO - 周期 8/20, 训练损失: 0.000818, 验证损失: 0.001116
2025-05-15 16:35:05,534 - lstm_model - INFO - 周期 9/20, 训练损失: 0.000811, 验证损失: 0.001086
2025-05-15 16:35:07,408 - lstm_model - INFO - 周期 10/20, 训练损失: 0.000797, 验证损失: 0.001057
2025-05-15 16:35:07,413 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:35:09,423 - lstm_model - INFO - 周期 11/20, 训练损失: 0.000794, 验证损失: 0.001224
2025-05-15 16:35:11,400 - lstm_model - INFO - 周期 12/20, 训练损失: 0.000807, 验证损失: 0.001032
2025-05-15 16:35:11,402 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:35:13,308 - lstm_model - INFO - 周期 13/20, 训练损失: 0.000792, 验证损失: 0.001152
2025-05-15 16:35:15,111 - lstm_model - INFO - 周期 14/20, 训练损失: 0.000786, 验证损失: 0.001055
2025-05-15 16:35:16,911 - lstm_model - INFO - 周期 15/20, 训练损失: 0.000806, 验证损失: 0.001202
2025-05-15 16:35:18,821 - lstm_model - INFO - 周期 16/20, 训练损失: 0.000790, 验证损失: 0.001059
2025-05-15 16:35:20,648 - lstm_model - INFO - 周期 17/20, 训练损失: 0.000768, 验证损失: 0.001110
2025-05-15 16:35:22,724 - lstm_model - INFO - 周期 18/20, 训练损失: 0.000770, 验证损失: 0.001121
2025-05-15 16:35:25,031 - lstm_model - INFO - 周期 19/20, 训练损失: 0.000769, 验证损失: 0.001079
2025-05-15 16:35:26,941 - lstm_model - INFO - 周期 20/20, 训练损失: 0.000757, 验证损失: 0.001372
2025-05-15 16:35:26,966 - lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:35:27,153 - evaluation - INFO - 模型 LSTM 评估结果:
2025-05-15 16:35:27,154 - evaluation - INFO - RMSE: 9.2836
2025-05-15 16:35:27,155 - evaluation - INFO - MAE: 6.3227
2025-05-15 16:35:27,155 - evaluation - INFO - R²: 0.9508
2025-05-15 16:35:27,155 - evaluation - INFO - MAPE: 18.6381%
2025-05-15 16:35:27,155 - evaluation - INFO - 执行时间: 38.6385 秒
2025-05-15 16:35:27,538 - time_series - INFO - LSTM模型完成，评估结果: RMSE=9.2836, MAE=6.3227
2025-05-15 16:35:27,539 - time_series - INFO - ==================================================
2025-05-15 16:35:27,539 - time_series - INFO - 开始CNN模型训练和预测
2025-05-15 16:35:27,540 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:35:27,540 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:35:27,540 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:35:27,540 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:35:27,542 - cnn_model - INFO - CNN模型初始化，设备: cuda
2025-05-15 16:35:27,542 - cnn_model - INFO - 模型结构: 输入通道=1, 序列长度=7
2025-05-15 16:35:27,542 - cnn_model - INFO - 开始训练CNN模型，总共20个周期
2025-05-15 16:35:30,219 - cnn_model - INFO - 周期 1/20, 训练损失: 0.003831, 验证损失: 0.002781
2025-05-15 16:35:30,222 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:35:31,893 - cnn_model - INFO - 周期 2/20, 训练损失: 0.001338, 验证损失: 0.002052
2025-05-15 16:35:31,893 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:35:33,586 - cnn_model - INFO - 周期 3/20, 训练损失: 0.001119, 验证损失: 0.001590
2025-05-15 16:35:33,589 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:35:35,100 - cnn_model - INFO - 周期 4/20, 训练损失: 0.001038, 验证损失: 0.001548
2025-05-15 16:35:35,102 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:35:36,669 - cnn_model - INFO - 周期 5/20, 训练损失: 0.000958, 验证损失: 0.001409
2025-05-15 16:35:36,671 - cnn_model - INFO - 模型改进，已保存最佳模型
