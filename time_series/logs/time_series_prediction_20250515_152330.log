2025-05-15 15:23:30,097 - time_series - INFO - 开始运行时间序列预测系统
2025-05-15 15:23:30,097 - time_series - INFO - 日志文件: time_series/logs\time_series_prediction_20250515_152330.log
2025-05-15 15:23:30,097 - data_utils - INFO - 正在加载数据集: time_series\北京-逐日.xlsx
2025-05-15 15:23:30,659 - data_utils - INFO - 数据集加载成功，形状: (3362, 9)
2025-05-15 15:23:30,668 - data_utils - INFO - 提取的AQI数据形状: (3362,)
2025-05-15 15:23:30,671 - data_utils - INFO - 创建的序列形状: X=(3355, 7), y=(3355,)
2025-05-15 15:23:30,671 - data_utils - INFO - 训练集形状: X=(2348, 7), y=(2348,)
2025-05-15 15:23:30,671 - data_utils - INFO - 验证集形状: X=(335, 7), y=(335,)
2025-05-15 15:23:30,671 - data_utils - INFO - 测试集形状: X=(672, 7), y=(672,)
2025-05-15 15:23:30,671 - data_processor - INFO - 数据处理器初始化，序列长度: 7, 批次大小: 32
2025-05-15 15:23:30,671 - time_series - INFO - ==================================================
2025-05-15 15:23:30,671 - time_series - INFO - 开始LSTM模型训练和预测
2025-05-15 15:23:30,677 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 15:23:30,677 - data_processor - INFO - 训练批次数: 74
2025-05-15 15:23:30,677 - data_processor - INFO - 验证批次数: 11
2025-05-15 15:23:30,677 - data_processor - INFO - 测试批次数: 21
2025-05-15 15:23:33,363 - lstm_model - INFO - LSTM模型初始化，设备: cuda
2025-05-15 15:23:33,363 - lstm_model - INFO - 模型结构: 输入大小=1, 隐藏大小=64, 层数=2
2025-05-15 15:23:33,363 - lstm_model - INFO - 开始训练LSTM模型，总共20个周期
2025-05-15 15:23:33,815 - lstm_model - INFO - 周期 1/20, 训练损失: 0.022859, 验证损失: 0.011010
2025-05-15 15:23:33,815 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:34,065 - lstm_model - INFO - 周期 2/20, 训练损失: 0.017273, 验证损失: 0.010534
2025-05-15 15:23:34,065 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:34,265 - lstm_model - INFO - 周期 3/20, 训练损失: 0.016215, 验证损失: 0.010181
2025-05-15 15:23:34,265 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:34,461 - lstm_model - INFO - 周期 4/20, 训练损失: 0.015363, 验证损失: 0.009118
2025-05-15 15:23:34,462 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:34,656 - lstm_model - INFO - 周期 5/20, 训练损失: 0.014507, 验证损失: 0.008846
2025-05-15 15:23:34,656 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:34,847 - lstm_model - INFO - 周期 6/20, 训练损失: 0.012932, 验证损失: 0.008956
2025-05-15 15:23:35,048 - lstm_model - INFO - 周期 7/20, 训练损失: 0.012117, 验证损失: 0.009373
2025-05-15 15:23:35,240 - lstm_model - INFO - 周期 8/20, 训练损失: 0.011888, 验证损失: 0.009999
2025-05-15 15:23:35,438 - lstm_model - INFO - 周期 9/20, 训练损失: 0.011955, 验证损失: 0.011048
2025-05-15 15:23:35,636 - lstm_model - INFO - 周期 10/20, 训练损失: 0.011586, 验证损失: 0.009854
2025-05-15 15:23:35,849 - lstm_model - INFO - 周期 11/20, 训练损失: 0.011686, 验证损失: 0.009732
2025-05-15 15:23:36,045 - lstm_model - INFO - 周期 12/20, 训练损失: 0.011960, 验证损失: 0.010376
2025-05-15 15:23:36,237 - lstm_model - INFO - 周期 13/20, 训练损失: 0.011839, 验证损失: 0.010204
2025-05-15 15:23:36,438 - lstm_model - INFO - 周期 14/20, 训练损失: 0.011573, 验证损失: 0.010732
2025-05-15 15:23:36,630 - lstm_model - INFO - 周期 15/20, 训练损失: 0.011516, 验证损失: 0.009665
2025-05-15 15:23:36,630 - lstm_model - INFO - 早停触发，10个周期内验证损失未改善
2025-05-15 15:23:36,647 - lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 15:23:36,668 - evaluation - INFO - 模型 LSTM 评估结果:
2025-05-15 15:23:36,669 - evaluation - INFO - RMSE: 36.8192
2025-05-15 15:23:36,669 - evaluation - INFO - MAE: 26.9298
2025-05-15 15:23:36,669 - evaluation - INFO - R²: 0.1460
2025-05-15 15:23:36,670 - evaluation - INFO - MAPE: 49.2106%
2025-05-15 15:23:36,670 - evaluation - INFO - 执行时间: 3.2842 秒
2025-05-15 15:23:37,119 - time_series - INFO - LSTM模型完成，评估结果: RMSE=36.8192, MAE=26.9298
2025-05-15 15:23:37,119 - time_series - INFO - ==================================================
2025-05-15 15:23:37,119 - time_series - INFO - 开始CNN模型训练和预测
2025-05-15 15:23:37,131 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 15:23:37,131 - data_processor - INFO - 训练批次数: 74
2025-05-15 15:23:37,131 - data_processor - INFO - 验证批次数: 11
2025-05-15 15:23:37,131 - data_processor - INFO - 测试批次数: 21
2025-05-15 15:23:37,134 - cnn_model - INFO - CNN模型初始化，设备: cuda
2025-05-15 15:23:37,135 - cnn_model - INFO - 模型结构: 输入通道=1, 序列长度=7
2025-05-15 15:23:37,135 - cnn_model - INFO - 开始训练CNN模型，总共20个周期
2025-05-15 15:23:38,121 - cnn_model - INFO - 周期 1/20, 训练损失: 0.021324, 验证损失: 0.013228
2025-05-15 15:23:38,121 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:38,299 - cnn_model - INFO - 周期 2/20, 训练损失: 0.016137, 验证损失: 0.010678
2025-05-15 15:23:38,299 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:38,482 - cnn_model - INFO - 周期 3/20, 训练损失: 0.015285, 验证损失: 0.011105
2025-05-15 15:23:38,656 - cnn_model - INFO - 周期 4/20, 训练损失: 0.014806, 验证损失: 0.009828
2025-05-15 15:23:38,665 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:38,853 - cnn_model - INFO - 周期 5/20, 训练损失: 0.014447, 验证损失: 0.009233
2025-05-15 15:23:38,853 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:39,038 - cnn_model - INFO - 周期 6/20, 训练损失: 0.013855, 验证损失: 0.009943
2025-05-15 15:23:39,216 - cnn_model - INFO - 周期 7/20, 训练损失: 0.013592, 验证损失: 0.010720
2025-05-15 15:23:39,403 - cnn_model - INFO - 周期 8/20, 训练损失: 0.013294, 验证损失: 0.009811
2025-05-15 15:23:39,588 - cnn_model - INFO - 周期 9/20, 训练损失: 0.013022, 验证损失: 0.009892
2025-05-15 15:23:39,777 - cnn_model - INFO - 周期 10/20, 训练损失: 0.012812, 验证损失: 0.009425
2025-05-15 15:23:39,962 - cnn_model - INFO - 周期 11/20, 训练损失: 0.012723, 验证损失: 0.010567
2025-05-15 15:23:40,155 - cnn_model - INFO - 周期 12/20, 训练损失: 0.012641, 验证损失: 0.008754
2025-05-15 15:23:40,156 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:40,363 - cnn_model - INFO - 周期 13/20, 训练损失: 0.012628, 验证损失: 0.008857
2025-05-15 15:23:40,552 - cnn_model - INFO - 周期 14/20, 训练损失: 0.012491, 验证损失: 0.009067
2025-05-15 15:23:40,736 - cnn_model - INFO - 周期 15/20, 训练损失: 0.012494, 验证损失: 0.009280
2025-05-15 15:23:40,918 - cnn_model - INFO - 周期 16/20, 训练损失: 0.012363, 验证损失: 0.008859
2025-05-15 15:23:41,094 - cnn_model - INFO - 周期 17/20, 训练损失: 0.012533, 验证损失: 0.009204
2025-05-15 15:23:41,280 - cnn_model - INFO - 周期 18/20, 训练损失: 0.012361, 验证损失: 0.008862
2025-05-15 15:23:41,475 - cnn_model - INFO - 周期 19/20, 训练损失: 0.012445, 验证损失: 0.009403
2025-05-15 15:23:41,687 - cnn_model - INFO - 周期 20/20, 训练损失: 0.012163, 验证损失: 0.009599
2025-05-15 15:23:41,696 - cnn_model - INFO - 训练完成，已加载最佳模型
2025-05-15 15:23:41,719 - evaluation - INFO - 模型 CNN 评估结果:
2025-05-15 15:23:41,719 - evaluation - INFO - RMSE: 36.7920
2025-05-15 15:23:41,719 - evaluation - INFO - MAE: 26.2928
2025-05-15 15:23:41,719 - evaluation - INFO - R²: 0.1473
2025-05-15 15:23:41,719 - evaluation - INFO - MAPE: 47.7559%
2025-05-15 15:23:41,719 - evaluation - INFO - 执行时间: 4.5612 秒
2025-05-15 15:23:41,913 - time_series - INFO - CNN模型完成，评估结果: RMSE=36.7920, MAE=26.2928
2025-05-15 15:23:41,913 - time_series - INFO - ==================================================
2025-05-15 15:23:41,918 - time_series - INFO - 开始CNN+LSTM模型训练和预测
2025-05-15 15:23:41,919 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 15:23:41,919 - data_processor - INFO - 训练批次数: 74
2025-05-15 15:23:41,919 - data_processor - INFO - 验证批次数: 11
2025-05-15 15:23:41,919 - data_processor - INFO - 测试批次数: 21
2025-05-15 15:23:41,922 - cnn_lstm_model - INFO - CNN+LSTM模型初始化，设备: cuda
2025-05-15 15:23:41,922 - cnn_lstm_model - INFO - 模型结构: 输入通道=1, 序列长度=7, LSTM隐藏大小=64
2025-05-15 15:23:41,922 - cnn_lstm_model - INFO - 开始训练CNN+LSTM模型，总共20个周期
2025-05-15 15:23:42,196 - cnn_lstm_model - INFO - 周期 1/20, 训练损失: 0.020723, 验证损失: 0.012693
2025-05-15 15:23:42,205 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:42,444 - cnn_lstm_model - INFO - 周期 2/20, 训练损失: 0.017166, 验证损失: 0.011308
2025-05-15 15:23:42,446 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:42,705 - cnn_lstm_model - INFO - 周期 3/20, 训练损失: 0.016821, 验证损失: 0.011498
2025-05-15 15:23:42,958 - cnn_lstm_model - INFO - 周期 4/20, 训练损失: 0.016479, 验证损失: 0.010425
2025-05-15 15:23:42,961 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:43,200 - cnn_lstm_model - INFO - 周期 5/20, 训练损失: 0.015112, 验证损失: 0.009207
2025-05-15 15:23:43,202 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:43,448 - cnn_lstm_model - INFO - 周期 6/20, 训练损失: 0.014125, 验证损失: 0.010026
2025-05-15 15:23:43,673 - cnn_lstm_model - INFO - 周期 7/20, 训练损失: 0.013537, 验证损失: 0.009169
2025-05-15 15:23:43,675 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:43,904 - cnn_lstm_model - INFO - 周期 8/20, 训练损失: 0.013385, 验证损失: 0.009548
2025-05-15 15:23:44,122 - cnn_lstm_model - INFO - 周期 9/20, 训练损失: 0.013186, 验证损失: 0.009244
2025-05-15 15:23:44,344 - cnn_lstm_model - INFO - 周期 10/20, 训练损失: 0.013191, 验证损失: 0.009718
2025-05-15 15:23:44,584 - cnn_lstm_model - INFO - 周期 11/20, 训练损失: 0.012966, 验证损失: 0.009229
2025-05-15 15:23:44,818 - cnn_lstm_model - INFO - 周期 12/20, 训练损失: 0.012945, 验证损失: 0.010313
2025-05-15 15:23:45,030 - cnn_lstm_model - INFO - 周期 13/20, 训练损失: 0.012825, 验证损失: 0.009468
2025-05-15 15:23:45,276 - cnn_lstm_model - INFO - 周期 14/20, 训练损失: 0.012757, 验证损失: 0.008824
2025-05-15 15:23:45,278 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 15:23:45,522 - cnn_lstm_model - INFO - 周期 15/20, 训练损失: 0.012640, 验证损失: 0.009305
2025-05-15 15:23:45,764 - cnn_lstm_model - INFO - 周期 16/20, 训练损失: 0.012693, 验证损失: 0.008945
2025-05-15 15:23:45,991 - cnn_lstm_model - INFO - 周期 17/20, 训练损失: 0.012622, 验证损失: 0.009280
2025-05-15 15:23:46,228 - cnn_lstm_model - INFO - 周期 18/20, 训练损失: 0.012569, 验证损失: 0.010246
2025-05-15 15:23:46,461 - cnn_lstm_model - INFO - 周期 19/20, 训练损失: 0.012610, 验证损失: 0.008903
2025-05-15 15:23:46,686 - cnn_lstm_model - INFO - 周期 20/20, 训练损失: 0.012436, 验证损失: 0.009984
2025-05-15 15:23:46,704 - cnn_lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 15:23:46,735 - evaluation - INFO - 模型 CNN+LSTM 评估结果:
2025-05-15 15:23:46,735 - evaluation - INFO - RMSE: 38.0774
2025-05-15 15:23:46,735 - evaluation - INFO - MAE: 28.0531
2025-05-15 15:23:46,735 - evaluation - INFO - R²: 0.0867
2025-05-15 15:23:46,735 - evaluation - INFO - MAPE: 53.7821%
2025-05-15 15:23:46,735 - evaluation - INFO - 执行时间: 4.7825 秒
2025-05-15 15:23:46,933 - time_series - INFO - CNN+LSTM模型完成，评估结果: RMSE=38.0774, MAE=28.0531
2025-05-15 15:23:46,933 - time_series - INFO - ==================================================
2025-05-15 15:23:46,933 - time_series - INFO - 开始Sklearn模型训练和预测
2025-05-15 15:23:46,933 - data_processor - INFO - Sklearn数据准备完成
2025-05-15 15:23:46,934 - data_processor - INFO - 重塑后的训练数据形状: (2348, 7)
2025-05-15 15:23:46,934 - data_processor - INFO - 重塑后的验证数据形状: (335, 7)
2025-05-15 15:23:46,935 - data_processor - INFO - 重塑后的测试数据形状: (672, 7)
2025-05-15 15:23:46,935 - sklearn_models - INFO - 初始化Sklearn模型集合
2025-05-15 15:23:46,935 - time_series - INFO - ------------------------------
2025-05-15 15:23:46,935 - time_series - INFO - 训练线性回归模型
2025-05-15 15:23:46,935 - sklearn_models - INFO - 训练线性回归模型
2025-05-15 15:23:46,950 - sklearn_models - INFO - 线性回归模型验证R²得分: 0.1253
2025-05-15 15:23:46,951 - sklearn_models - INFO - 使用 linear_regression 模型进行预测
2025-05-15 15:23:46,952 - evaluation - INFO - 模型 线性回归 评估结果:
2025-05-15 15:23:46,953 - evaluation - INFO - RMSE: 38.9289
2025-05-15 15:23:46,954 - evaluation - INFO - MAE: 27.4714
2025-05-15 15:23:46,954 - evaluation - INFO - R²: 0.0454
2025-05-15 15:23:46,954 - evaluation - INFO - MAPE: 52.5625%
2025-05-15 15:23:46,954 - evaluation - INFO - 执行时间: 0.0165 秒
2025-05-15 15:23:47,141 - time_series - INFO - ------------------------------
2025-05-15 15:23:47,141 - time_series - INFO - 训练决策树模型
2025-05-15 15:23:47,141 - sklearn_models - INFO - 训练决策树模型，参数: {'max_depth': 10, 'random_state': 42}
2025-05-15 15:23:47,145 - sklearn_models - INFO - 决策树模型验证R²得分: -0.2476
2025-05-15 15:23:47,145 - sklearn_models - INFO - 使用 decision_tree 模型进行预测
2025-05-15 15:23:47,161 - evaluation - INFO - 模型 决策树 评估结果:
2025-05-15 15:23:47,161 - evaluation - INFO - RMSE: 43.2959
2025-05-15 15:23:47,161 - evaluation - INFO - MAE: 29.6598
2025-05-15 15:23:47,162 - evaluation - INFO - R²: -0.1808
2025-05-15 15:23:47,162 - evaluation - INFO - MAPE: 53.2491%
2025-05-15 15:23:47,162 - evaluation - INFO - 执行时间: 0.0046 秒
2025-05-15 15:23:47,363 - time_series - INFO - ------------------------------
2025-05-15 15:23:47,363 - time_series - INFO - 训练随机森林模型
2025-05-15 15:23:47,363 - sklearn_models - INFO - 训练随机森林模型，参数: {'n_estimators': 100, 'max_depth': 10, 'random_state': 42}
2025-05-15 15:23:48,203 - sklearn_models - INFO - 随机森林模型验证R²得分: 0.2136
2025-05-15 15:23:48,203 - sklearn_models - INFO - 使用 random_forest 模型进行预测
2025-05-15 15:23:48,203 - evaluation - INFO - 模型 随机森林 评估结果:
2025-05-15 15:23:48,203 - evaluation - INFO - RMSE: 38.9548
2025-05-15 15:23:48,218 - evaluation - INFO - MAE: 26.6795
2025-05-15 15:23:48,218 - evaluation - INFO - R²: 0.0441
2025-05-15 15:23:48,218 - evaluation - INFO - MAPE: 49.5387%
2025-05-15 15:23:48,218 - evaluation - INFO - 执行时间: 0.8403 秒
2025-05-15 15:23:48,444 - time_series - INFO - ------------------------------
2025-05-15 15:23:48,444 - time_series - INFO - 训练XGBoost模型
2025-05-15 15:23:48,444 - sklearn_models - INFO - 训练XGBoost模型，参数: {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'objective': 'reg:squarederror', 'random_state': 42}
2025-05-15 15:23:48,652 - sklearn_models - INFO - XGBoost模型验证R²得分: 0.1838
2025-05-15 15:23:48,652 - sklearn_models - INFO - 使用 xgboost 模型进行预测
2025-05-15 15:23:48,652 - evaluation - INFO - 模型 XGBoost 评估结果:
2025-05-15 15:23:48,652 - evaluation - INFO - RMSE: 40.2122
2025-05-15 15:23:48,652 - evaluation - INFO - MAE: 27.5701
2025-05-15 15:23:48,652 - evaluation - INFO - R²: -0.0186
2025-05-15 15:23:48,652 - evaluation - INFO - MAPE: 50.4603%
2025-05-15 15:23:48,652 - evaluation - INFO - 执行时间: 0.2087 秒
2025-05-15 15:23:48,902 - time_series - INFO - 所有Sklearn模型训练完成
2025-05-15 15:23:49,747 - time_series - INFO - 所有结果已保存到 time_series/results\all_models_comparison.xlsx
2025-05-15 15:23:49,747 - time_series - INFO - 时间序列预测系统运行完成
