2025-05-15 16:26:50,093 - time_series - INFO - 开始运行时间序列预测系统
2025-05-15 16:26:50,093 - time_series - INFO - 日志文件: time_series/logs\time_series_prediction_20250515_162650.log
2025-05-15 16:26:50,093 - data_utils - INFO - 正在加载数据集: time_series\北京-逐日.xlsx
2025-05-15 16:26:51,601 - data_utils - INFO - 数据集加载成功，形状: (27814, 3)
2025-05-15 16:26:51,601 - data_utils - INFO - 提取的AQI数据形状: (27814,)
2025-05-15 16:26:51,634 - data_utils - INFO - 创建的序列形状: X=(27807, 7), y=(27807,)
2025-05-15 16:26:51,636 - data_utils - INFO - 训练集形状: X=(19464, 7), y=(19464,)
2025-05-15 16:26:51,636 - data_utils - INFO - 验证集形状: X=(2780, 7), y=(2780,)
2025-05-15 16:26:51,640 - data_utils - INFO - 测试集形状: X=(5563, 7), y=(5563,)
2025-05-15 16:26:51,640 - data_processor - INFO - 数据处理器初始化，序列长度: 7, 批次大小: 32
2025-05-15 16:26:51,640 - time_series - INFO - ==================================================
2025-05-15 16:26:51,640 - time_series - INFO - 开始LSTM模型训练和预测
2025-05-15 16:26:51,644 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:26:51,645 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:26:51,645 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:26:51,645 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:26:55,222 - lstm_model - INFO - LSTM模型初始化，设备: cuda
2025-05-15 16:26:55,222 - lstm_model - INFO - 模型结构: 输入大小=1, 隐藏大小=64, 层数=2
2025-05-15 16:26:55,222 - lstm_model - INFO - 开始训练LSTM模型，总共20个周期
2025-05-15 16:26:57,281 - lstm_model - INFO - 周期 1/20, 训练损失: 0.002983, 验证损失: 0.002231
2025-05-15 16:26:57,281 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:26:59,034 - lstm_model - INFO - 周期 2/20, 训练损失: 0.001105, 验证损失: 0.001151
2025-05-15 16:26:59,038 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:00,850 - lstm_model - INFO - 周期 3/20, 训练损失: 0.000909, 验证损失: 0.001068
2025-05-15 16:27:00,855 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:02,584 - lstm_model - INFO - 周期 4/20, 训练损失: 0.000856, 验证损失: 0.001164
2025-05-15 16:27:04,334 - lstm_model - INFO - 周期 5/20, 训练损失: 0.000842, 验证损失: 0.001100
2025-05-15 16:27:06,155 - lstm_model - INFO - 周期 6/20, 训练损失: 0.000830, 验证损失: 0.001075
2025-05-15 16:27:07,976 - lstm_model - INFO - 周期 7/20, 训练损失: 0.000817, 验证损失: 0.001105
2025-05-15 16:27:09,871 - lstm_model - INFO - 周期 8/20, 训练损失: 0.000811, 验证损失: 0.001173
2025-05-15 16:27:11,757 - lstm_model - INFO - 周期 9/20, 训练损失: 0.000815, 验证损失: 0.001200
2025-05-15 16:27:13,696 - lstm_model - INFO - 周期 10/20, 训练损失: 0.000819, 验证损失: 0.001057
2025-05-15 16:27:13,700 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:15,478 - lstm_model - INFO - 周期 11/20, 训练损失: 0.000797, 验证损失: 0.001093
2025-05-15 16:27:17,395 - lstm_model - INFO - 周期 12/20, 训练损失: 0.000798, 验证损失: 0.001087
2025-05-15 16:27:19,194 - lstm_model - INFO - 周期 13/20, 训练损失: 0.000795, 验证损失: 0.001151
2025-05-15 16:27:21,076 - lstm_model - INFO - 周期 14/20, 训练损失: 0.000796, 验证损失: 0.001044
2025-05-15 16:27:21,078 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:22,969 - lstm_model - INFO - 周期 15/20, 训练损失: 0.000795, 验证损失: 0.001193
2025-05-15 16:27:24,933 - lstm_model - INFO - 周期 16/20, 训练损失: 0.000787, 验证损失: 0.001055
2025-05-15 16:27:26,856 - lstm_model - INFO - 周期 17/20, 训练损失: 0.000780, 验证损失: 0.001104
2025-05-15 16:27:28,752 - lstm_model - INFO - 周期 18/20, 训练损失: 0.000862, 验证损失: 0.001387
2025-05-15 16:27:30,601 - lstm_model - INFO - 周期 19/20, 训练损失: 0.000784, 验证损失: 0.001077
2025-05-15 16:27:32,791 - lstm_model - INFO - 周期 20/20, 训练损失: 0.000762, 验证损失: 0.001129
2025-05-15 16:27:32,809 - lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:27:32,995 - evaluation - INFO - 模型 LSTM 评估结果:
2025-05-15 16:27:32,995 - evaluation - INFO - RMSE: 8.7609
2025-05-15 16:27:32,995 - evaluation - INFO - MAE: 5.1988
2025-05-15 16:27:32,995 - evaluation - INFO - R²: 0.9562
2025-05-15 16:27:32,995 - evaluation - INFO - MAPE: 13.4756%
2025-05-15 16:27:32,995 - evaluation - INFO - 执行时间: 37.5863 秒
2025-05-15 16:27:33,388 - time_series - INFO - LSTM模型完成，评估结果: RMSE=8.7609, MAE=5.1988
2025-05-15 16:27:33,388 - time_series - INFO - ==================================================
2025-05-15 16:27:33,388 - time_series - INFO - 开始CNN模型训练和预测
2025-05-15 16:27:33,390 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:27:33,390 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:27:33,390 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:27:33,391 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:27:33,393 - cnn_model - INFO - CNN模型初始化，设备: cuda
2025-05-15 16:27:33,394 - cnn_model - INFO - 模型结构: 输入通道=1, 序列长度=7
2025-05-15 16:27:33,395 - cnn_model - INFO - 开始训练CNN模型，总共20个周期
2025-05-15 16:27:36,041 - cnn_model - INFO - 周期 1/20, 训练损失: 0.003503, 验证损失: 0.003016
2025-05-15 16:27:36,043 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:37,790 - cnn_model - INFO - 周期 2/20, 训练损失: 0.001378, 验证损失: 0.002111
2025-05-15 16:27:37,792 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:39,425 - cnn_model - INFO - 周期 3/20, 训练损失: 0.001178, 验证损失: 0.001754
2025-05-15 16:27:39,428 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:41,174 - cnn_model - INFO - 周期 4/20, 训练损失: 0.001096, 验证损失: 0.001692
2025-05-15 16:27:41,176 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:42,779 - cnn_model - INFO - 周期 5/20, 训练损失: 0.001035, 验证损失: 0.001625
2025-05-15 16:27:42,789 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:44,503 - cnn_model - INFO - 周期 6/20, 训练损失: 0.001011, 验证损失: 0.001420
2025-05-15 16:27:44,506 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:46,151 - cnn_model - INFO - 周期 7/20, 训练损失: 0.000967, 验证损失: 0.001411
2025-05-15 16:27:46,153 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:48,086 - cnn_model - INFO - 周期 8/20, 训练损失: 0.000925, 验证损失: 0.001395
2025-05-15 16:27:48,088 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:49,684 - cnn_model - INFO - 周期 9/20, 训练损失: 0.000897, 验证损失: 0.001349
2025-05-15 16:27:49,684 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:51,125 - cnn_model - INFO - 周期 10/20, 训练损失: 0.000863, 验证损失: 0.001491
2025-05-15 16:27:52,569 - cnn_model - INFO - 周期 11/20, 训练损失: 0.000870, 验证损失: 0.001467
2025-05-15 16:27:54,011 - cnn_model - INFO - 周期 12/20, 训练损失: 0.000866, 验证损失: 0.001276
2025-05-15 16:27:54,015 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:27:55,578 - cnn_model - INFO - 周期 13/20, 训练损失: 0.000826, 验证损失: 0.001359
2025-05-15 16:27:57,087 - cnn_model - INFO - 周期 14/20, 训练损失: 0.000837, 验证损失: 0.001295
2025-05-15 16:27:58,546 - cnn_model - INFO - 周期 15/20, 训练损失: 0.000816, 验证损失: 0.001281
2025-05-15 16:28:00,024 - cnn_model - INFO - 周期 16/20, 训练损失: 0.000813, 验证损失: 0.001226
2025-05-15 16:28:00,025 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:01,518 - cnn_model - INFO - 周期 17/20, 训练损失: 0.000784, 验证损失: 0.001228
2025-05-15 16:28:03,038 - cnn_model - INFO - 周期 18/20, 训练损失: 0.000795, 验证损失: 0.001243
2025-05-15 16:28:04,555 - cnn_model - INFO - 周期 19/20, 训练损失: 0.000799, 验证损失: 0.001224
2025-05-15 16:28:04,558 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:06,100 - cnn_model - INFO - 周期 20/20, 训练损失: 0.000792, 验证损失: 0.001259
2025-05-15 16:28:06,115 - cnn_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:28:06,277 - evaluation - INFO - 模型 CNN 评估结果:
2025-05-15 16:28:06,277 - evaluation - INFO - RMSE: 10.3962
2025-05-15 16:28:06,277 - evaluation - INFO - MAE: 6.7437
2025-05-15 16:28:06,277 - evaluation - INFO - R²: 0.9383
2025-05-15 16:28:06,277 - evaluation - INFO - MAPE: 16.2753%
2025-05-15 16:28:06,277 - evaluation - INFO - 执行时间: 32.7213 秒
2025-05-15 16:28:06,545 - time_series - INFO - CNN模型完成，评估结果: RMSE=10.3962, MAE=6.7437
2025-05-15 16:28:06,545 - time_series - INFO - ==================================================
2025-05-15 16:28:06,545 - time_series - INFO - 开始CNN+LSTM模型训练和预测
2025-05-15 16:28:06,549 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:28:06,549 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:28:06,549 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:28:06,549 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:28:06,549 - cnn_lstm_model - INFO - CNN+LSTM模型初始化，设备: cuda
2025-05-15 16:28:06,549 - cnn_lstm_model - INFO - 模型结构: 输入通道=1, 序列长度=7, LSTM隐藏大小=64
2025-05-15 16:28:06,549 - cnn_lstm_model - INFO - 开始训练CNN+LSTM模型，总共20个周期
2025-05-15 16:28:08,553 - cnn_lstm_model - INFO - 周期 1/20, 训练损失: 0.002494, 验证损失: 0.002077
2025-05-15 16:28:08,557 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:10,461 - cnn_lstm_model - INFO - 周期 2/20, 训练损失: 0.001171, 验证损失: 0.001670
2025-05-15 16:28:10,461 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:12,419 - cnn_lstm_model - INFO - 周期 3/20, 训练损失: 0.001047, 验证损失: 0.001590
2025-05-15 16:28:12,423 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:14,331 - cnn_lstm_model - INFO - 周期 4/20, 训练损失: 0.000988, 验证损失: 0.001548
2025-05-15 16:28:14,331 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:16,275 - cnn_lstm_model - INFO - 周期 5/20, 训练损失: 0.000907, 验证损失: 0.001504
2025-05-15 16:28:16,275 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:18,247 - cnn_lstm_model - INFO - 周期 6/20, 训练损失: 0.000887, 验证损失: 0.001490
2025-05-15 16:28:18,249 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:20,218 - cnn_lstm_model - INFO - 周期 7/20, 训练损失: 0.000874, 验证损失: 0.001489
2025-05-15 16:28:20,218 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:22,214 - cnn_lstm_model - INFO - 周期 8/20, 训练损失: 0.000847, 验证损失: 0.001570
2025-05-15 16:28:24,298 - cnn_lstm_model - INFO - 周期 9/20, 训练损失: 0.000842, 验证损失: 0.001301
2025-05-15 16:28:24,302 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:26,352 - cnn_lstm_model - INFO - 周期 10/20, 训练损失: 0.000829, 验证损失: 0.001380
2025-05-15 16:28:28,306 - cnn_lstm_model - INFO - 周期 11/20, 训练损失: 0.000797, 验证损失: 0.001347
2025-05-15 16:28:30,291 - cnn_lstm_model - INFO - 周期 12/20, 训练损失: 0.000802, 验证损失: 0.001313
2025-05-15 16:28:32,507 - cnn_lstm_model - INFO - 周期 13/20, 训练损失: 0.000783, 验证损失: 0.001250
2025-05-15 16:28:32,507 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:28:34,521 - cnn_lstm_model - INFO - 周期 14/20, 训练损失: 0.000787, 验证损失: 0.001329
2025-05-15 16:28:36,576 - cnn_lstm_model - INFO - 周期 15/20, 训练损失: 0.000793, 验证损失: 0.001368
2025-05-15 16:28:38,544 - cnn_lstm_model - INFO - 周期 16/20, 训练损失: 0.000785, 验证损失: 0.001341
2025-05-15 16:28:40,661 - cnn_lstm_model - INFO - 周期 17/20, 训练损失: 0.000774, 验证损失: 0.001384
2025-05-15 16:28:43,031 - cnn_lstm_model - INFO - 周期 18/20, 训练损失: 0.000784, 验证损失: 0.001251
2025-05-15 16:28:45,262 - cnn_lstm_model - INFO - 周期 19/20, 训练损失: 0.000768, 验证损失: 0.001272
2025-05-15 16:28:47,291 - cnn_lstm_model - INFO - 周期 20/20, 训练损失: 0.000777, 验证损失: 0.001299
2025-05-15 16:28:47,322 - cnn_lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:28:47,525 - evaluation - INFO - 模型 CNN+LSTM 评估结果:
2025-05-15 16:28:47,525 - evaluation - INFO - RMSE: 9.4994
2025-05-15 16:28:47,525 - evaluation - INFO - MAE: 5.8057
2025-05-15 16:28:47,525 - evaluation - INFO - R²: 0.9485
2025-05-15 16:28:47,525 - evaluation - INFO - MAPE: 13.5200%
2025-05-15 16:28:47,525 - evaluation - INFO - 执行时间: 40.7736 秒
2025-05-15 16:28:47,783 - time_series - INFO - CNN+LSTM模型完成，评估结果: RMSE=9.4994, MAE=5.8057
2025-05-15 16:28:47,783 - time_series - INFO - ==================================================
2025-05-15 16:28:47,783 - time_series - INFO - 开始Sklearn模型训练和预测
2025-05-15 16:28:47,783 - data_processor - INFO - Sklearn数据准备完成
2025-05-15 16:28:47,783 - data_processor - INFO - 重塑后的训练数据形状: (19464, 7)
2025-05-15 16:28:47,783 - data_processor - INFO - 重塑后的验证数据形状: (2780, 7)
2025-05-15 16:28:47,783 - data_processor - INFO - 重塑后的测试数据形状: (5563, 7)
2025-05-15 16:28:47,783 - sklearn_models - INFO - 初始化Sklearn模型集合
2025-05-15 16:28:47,783 - time_series - INFO - ------------------------------
2025-05-15 16:28:47,783 - time_series - INFO - 训练线性回归模型
2025-05-15 16:28:47,783 - sklearn_models - INFO - 训练线性回归模型
2025-05-15 16:28:47,786 - sklearn_models - INFO - 线性回归模型验证R²得分: 0.8776
2025-05-15 16:28:47,786 - sklearn_models - INFO - 使用 linear_regression 模型进行预测
2025-05-15 16:28:47,792 - evaluation - INFO - 模型 线性回归 评估结果:
2025-05-15 16:28:47,792 - evaluation - INFO - RMSE: 8.8401
2025-05-15 16:28:47,792 - evaluation - INFO - MAE: 5.1610
2025-05-15 16:28:47,793 - evaluation - INFO - R²: 0.9554
2025-05-15 16:28:47,793 - evaluation - INFO - MAPE: 12.8423%
2025-05-15 16:28:47,793 - evaluation - INFO - 执行时间: 0.0030 秒
2025-05-15 16:28:48,050 - time_series - INFO - ------------------------------
2025-05-15 16:28:48,050 - time_series - INFO - 训练决策树模型
2025-05-15 16:28:48,050 - sklearn_models - INFO - 训练决策树模型，参数: {'max_depth': 10, 'random_state': 42}
2025-05-15 16:28:48,110 - sklearn_models - INFO - 决策树模型验证R²得分: 0.8601
2025-05-15 16:28:48,110 - sklearn_models - INFO - 使用 decision_tree 模型进行预测
2025-05-15 16:28:48,113 - evaluation - INFO - 模型 决策树 评估结果:
2025-05-15 16:28:48,113 - evaluation - INFO - RMSE: 9.4953
2025-05-15 16:28:48,113 - evaluation - INFO - MAE: 5.3617
2025-05-15 16:28:48,113 - evaluation - INFO - R²: 0.9485
2025-05-15 16:28:48,114 - evaluation - INFO - MAPE: 12.6134%
2025-05-15 16:28:48,114 - evaluation - INFO - 执行时间: 0.0597 秒
2025-05-15 16:28:48,348 - time_series - INFO - ------------------------------
2025-05-15 16:28:48,348 - time_series - INFO - 训练随机森林模型
2025-05-15 16:28:48,348 - sklearn_models - INFO - 训练随机森林模型，参数: {'n_estimators': 100, 'max_depth': 10, 'random_state': 42}
2025-05-15 16:28:53,023 - sklearn_models - INFO - 随机森林模型验证R²得分: 0.8886
2025-05-15 16:28:53,023 - sklearn_models - INFO - 使用 random_forest 模型进行预测
2025-05-15 16:28:53,070 - evaluation - INFO - 模型 随机森林 评估结果:
2025-05-15 16:28:53,071 - evaluation - INFO - RMSE: 8.7157
2025-05-15 16:28:53,071 - evaluation - INFO - MAE: 4.9895
2025-05-15 16:28:53,071 - evaluation - INFO - R²: 0.9566
2025-05-15 16:28:53,071 - evaluation - INFO - MAPE: 12.2481%
2025-05-15 16:28:53,072 - evaluation - INFO - 执行时间: 4.6752 秒
2025-05-15 16:28:53,352 - time_series - INFO - ------------------------------
2025-05-15 16:28:53,352 - time_series - INFO - 训练XGBoost模型
2025-05-15 16:28:53,352 - sklearn_models - INFO - 训练XGBoost模型，参数: {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'objective': 'reg:squarederror', 'random_state': 42}
2025-05-15 16:28:53,599 - sklearn_models - INFO - XGBoost模型验证R²得分: 0.8776
2025-05-15 16:28:53,600 - sklearn_models - INFO - 使用 xgboost 模型进行预测
2025-05-15 16:28:53,606 - evaluation - INFO - 模型 XGBoost 评估结果:
2025-05-15 16:28:53,606 - evaluation - INFO - RMSE: 8.7086
2025-05-15 16:28:53,606 - evaluation - INFO - MAE: 4.9935
2025-05-15 16:28:53,606 - evaluation - INFO - R²: 0.9567
2025-05-15 16:28:53,608 - evaluation - INFO - MAPE: 12.2249%
2025-05-15 16:28:53,608 - evaluation - INFO - 执行时间: 0.2478 秒
2025-05-15 16:28:53,922 - time_series - INFO - ------------------------------
2025-05-15 16:28:53,922 - time_series - INFO - 训练SVM模型
2025-05-15 16:28:53,922 - sklearn_models - INFO - 训练SVM模型，参数: {'kernel': 'rbf', 'C': 1.0, 'epsilon': 0.1}
2025-05-15 16:28:54,385 - sklearn_models - INFO - SVM模型验证R²得分: 0.7728
2025-05-15 16:28:54,385 - sklearn_models - INFO - 使用 svm 模型进行预测
2025-05-15 16:28:54,513 - evaluation - INFO - 模型 SVM 评估结果:
2025-05-15 16:28:54,514 - evaluation - INFO - RMSE: 21.3378
2025-05-15 16:28:54,515 - evaluation - INFO - MAE: 18.0252
2025-05-15 16:28:54,515 - evaluation - INFO - R²: 0.7402
2025-05-15 16:28:54,515 - evaluation - INFO - MAPE: 67.9728%
2025-05-15 16:28:54,515 - evaluation - INFO - 执行时间: 0.4631 秒
2025-05-15 16:28:54,777 - time_series - INFO - ------------------------------
2025-05-15 16:28:54,777 - time_series - INFO - 训练梯度提升树模型
2025-05-15 16:28:54,778 - sklearn_models - INFO - 训练Gradient Boosting模型，参数: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': 3, 'random_state': 42}
2025-05-15 16:28:56,749 - sklearn_models - INFO - Gradient Boosting模型验证R²得分: 0.8632
2025-05-15 16:28:56,749 - sklearn_models - INFO - 使用 gradient_boosting 模型进行预测
2025-05-15 16:28:56,767 - evaluation - INFO - 模型 梯度提升树 评估结果:
2025-05-15 16:28:56,767 - evaluation - INFO - RMSE: 8.7235
2025-05-15 16:28:56,767 - evaluation - INFO - MAE: 5.1766
2025-05-15 16:28:56,767 - evaluation - INFO - R²: 0.9566
2025-05-15 16:28:56,767 - evaluation - INFO - MAPE: 13.0284%
2025-05-15 16:28:56,769 - evaluation - INFO - 执行时间: 1.9712 秒
2025-05-15 16:28:57,017 - time_series - INFO - ------------------------------
2025-05-15 16:28:57,017 - time_series - INFO - 训练LightGBM模型
2025-05-15 16:28:57,017 - sklearn_models - INFO - 训练LightGBM模型，参数: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'random_state': 42, 'verbose': -1}
2025-05-15 16:28:57,199 - sklearn_models - INFO - LightGBM模型验证R²得分: 0.8872
2025-05-15 16:28:57,199 - sklearn_models - INFO - 使用 lightgbm 模型进行预测
2025-05-15 16:28:57,216 - evaluation - INFO - 模型 LightGBM 评估结果:
2025-05-15 16:28:57,217 - evaluation - INFO - RMSE: 8.8139
2025-05-15 16:28:57,217 - evaluation - INFO - MAE: 5.0413
2025-05-15 16:28:57,217 - evaluation - INFO - R²: 0.9557
2025-05-15 16:28:57,218 - evaluation - INFO - MAPE: 12.3964%
2025-05-15 16:28:57,218 - evaluation - INFO - 执行时间: 0.1822 秒
2025-05-15 16:28:57,512 - time_series - INFO - ------------------------------
2025-05-15 16:28:57,512 - time_series - INFO - 训练CatBoost模型
2025-05-15 16:28:57,512 - sklearn_models - INFO - 训练CatBoost模型，参数: {'iterations': 100, 'learning_rate': 0.1, 'depth': 6, 'random_state': 42, 'verbose': 0}
2025-05-15 16:28:58,294 - sklearn_models - INFO - CatBoost模型验证R²得分: 0.8789
2025-05-15 16:28:58,294 - sklearn_models - INFO - 使用 catboost 模型进行预测
2025-05-15 16:28:58,309 - evaluation - INFO - 模型 CatBoost 评估结果:
2025-05-15 16:28:58,309 - evaluation - INFO - RMSE: 8.9734
2025-05-15 16:28:58,309 - evaluation - INFO - MAE: 5.3235
2025-05-15 16:28:58,309 - evaluation - INFO - R²: 0.9540
2025-05-15 16:28:58,309 - evaluation - INFO - MAPE: 13.4418%
2025-05-15 16:28:58,309 - evaluation - INFO - 执行时间: 0.7819 秒
2025-05-15 16:28:58,620 - time_series - INFO - 所有Sklearn模型训练完成
2025-05-15 16:28:58,623 - time_series - INFO - ==================================================
2025-05-15 16:28:58,623 - time_series - INFO - 开始ARIMA模型训练和预测
2025-05-15 16:28:58,623 - time_series - ERROR - 运行ARIMA模型时发生错误: 'TimeSeriesDataProcessor' object has no attribute 'data_dict'
2025-05-15 16:28:58,624 - time_series - INFO - ==================================================
2025-05-15 16:28:58,624 - time_series - INFO - 开始Prophet模型训练和预测
2025-05-15 16:28:58,624 - time_series - WARNING - Prophet模型：未找到明确的 '日期' 列，将尝试使用索引生成日期。
2025-05-15 16:28:58,625 - time_series - INFO - Prophet模型：将使用第一列 'date' 作为日期列。
2025-05-15 16:28:58,629 - time_series - ERROR - 运行Prophet模型时发生错误: 'TimeSeriesDataProcessor' object has no attribute 'data_dict'
2025-05-15 16:28:58,629 - time_series - INFO - ==================================================
2025-05-15 16:28:58,629 - time_series - INFO - 开始Transformer模型训练和预测
2025-05-15 16:28:58,631 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:28:58,632 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:28:58,632 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:28:58,632 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:28:58,645 - transformer_model - INFO - TransformerModel initialized on cuda
2025-05-15 16:28:58,645 - transformer_model - INFO - Model params: input_size=1, d_model=64, nhead=4, layers=2, ff_dim=128, output_size=1, seq_len=7
2025-05-15 16:28:58,645 - transformer_model - INFO - Starting Transformer training for 20 epochs.
2025-05-15 16:29:05,017 - transformer_model - INFO - Epoch 1/20, Train Loss: 0.0154, Val Loss: 0.0097
2025-05-15 16:29:05,018 - transformer_model - INFO - New best validation loss: 0.0097. Saving model state.
2025-05-15 16:29:11,327 - transformer_model - INFO - Epoch 2/20, Train Loss: 0.0116, Val Loss: 0.0086
2025-05-15 16:29:11,327 - transformer_model - INFO - New best validation loss: 0.0086. Saving model state.
2025-05-15 16:29:17,148 - transformer_model - INFO - Epoch 3/20, Train Loss: 0.0114, Val Loss: 0.0089
2025-05-15 16:29:22,857 - transformer_model - INFO - Epoch 4/20, Train Loss: 0.0113, Val Loss: 0.0091
2025-05-15 16:29:28,640 - transformer_model - INFO - Epoch 5/20, Train Loss: 0.0114, Val Loss: 0.0090
2025-05-15 16:29:34,427 - transformer_model - INFO - Epoch 6/20, Train Loss: 0.0113, Val Loss: 0.0087
2025-05-15 16:29:40,237 - transformer_model - INFO - Epoch 7/20, Train Loss: 0.0112, Val Loss: 0.0089
2025-05-15 16:29:46,121 - transformer_model - INFO - Epoch 8/20, Train Loss: 0.0112, Val Loss: 0.0086
2025-05-15 16:29:51,966 - transformer_model - INFO - Epoch 9/20, Train Loss: 0.0112, Val Loss: 0.0101
2025-05-15 16:29:57,760 - transformer_model - INFO - Epoch 10/20, Train Loss: 0.0113, Val Loss: 0.0086
2025-05-15 16:30:03,619 - transformer_model - INFO - Epoch 11/20, Train Loss: 0.0111, Val Loss: 0.0096
2025-05-15 16:30:09,497 - transformer_model - INFO - Epoch 12/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:30:15,920 - transformer_model - INFO - Epoch 13/20, Train Loss: 0.0111, Val Loss: 0.0090
2025-05-15 16:30:21,993 - transformer_model - INFO - Epoch 14/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:30:28,500 - transformer_model - INFO - Epoch 15/20, Train Loss: 0.0111, Val Loss: 0.0090
2025-05-15 16:30:34,830 - transformer_model - INFO - Epoch 16/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:30:41,174 - transformer_model - INFO - Epoch 17/20, Train Loss: 0.0111, Val Loss: 0.0089
2025-05-15 16:30:47,995 - transformer_model - INFO - Epoch 18/20, Train Loss: 0.0111, Val Loss: 0.0093
2025-05-15 16:30:54,246 - transformer_model - INFO - Epoch 19/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:31:01,141 - transformer_model - INFO - Epoch 20/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:31:01,141 - transformer_model - INFO - Loaded best model state for Transformer.
2025-05-15 16:31:01,437 - evaluation - INFO - 模型 Transformer 评估结果:
2025-05-15 16:31:01,438 - evaluation - INFO - RMSE: 46.1021
2025-05-15 16:31:01,438 - evaluation - INFO - MAE: 38.9667
2025-05-15 16:31:01,438 - evaluation - INFO - R²: -0.2130
2025-05-15 16:31:01,438 - evaluation - INFO - MAPE: 127.4244%
2025-05-15 16:31:01,439 - evaluation - INFO - 执行时间: 122.4957 秒
2025-05-15 16:31:01,687 - time_series - INFO - Transformer模型完成，评估结果: RMSE=46.1021, MAE=38.9667, R2=-0.2130
2025-05-15 16:31:01,687 - time_series - INFO - ==================================================
2025-05-15 16:31:01,687 - time_series - INFO - 开始CNN-LSTM-Attention模型训练和预测
2025-05-15 16:31:01,687 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:31:01,692 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:31:01,692 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:31:01,692 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:31:01,696 - cnn_lstm_attention_model - INFO - CNNLSTMAttentionModel initialized on cuda
2025-05-15 16:31:01,696 - cnn_lstm_attention_model - INFO - Model params: input_channels=1, seq_length=7, lstm_hidden=64, cnn_out=32
2025-05-15 16:31:01,696 - cnn_lstm_attention_model - INFO - Starting CNN-LSTM-Attention training for 20 epochs.
2025-05-15 16:31:04,363 - cnn_lstm_attention_model - INFO - Epoch 1/20, Train Loss: 0.0113, Val Loss: 0.0095
2025-05-15 16:31:04,363 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0095. Saving model state.
2025-05-15 16:31:06,958 - cnn_lstm_attention_model - INFO - Epoch 2/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:31:06,958 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0088. Saving model state.
2025-05-15 16:31:09,535 - cnn_lstm_attention_model - INFO - Epoch 3/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:31:09,535 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0086. Saving model state.
2025-05-15 16:31:12,288 - cnn_lstm_attention_model - INFO - Epoch 4/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:31:14,901 - cnn_lstm_attention_model - INFO - Epoch 5/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:31:17,509 - cnn_lstm_attention_model - INFO - Epoch 6/20, Train Loss: 0.0111, Val Loss: 0.0085
2025-05-15 16:31:17,509 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0085. Saving model state.
2025-05-15 16:31:20,470 - cnn_lstm_attention_model - INFO - Epoch 7/20, Train Loss: 0.0111, Val Loss: 0.0089
2025-05-15 16:31:23,077 - cnn_lstm_attention_model - INFO - Epoch 8/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:31:25,651 - cnn_lstm_attention_model - INFO - Epoch 9/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:31:28,235 - cnn_lstm_attention_model - INFO - Epoch 10/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:31:31,163 - cnn_lstm_attention_model - INFO - Epoch 11/20, Train Loss: 0.0111, Val Loss: 0.0089
2025-05-15 16:31:33,962 - cnn_lstm_attention_model - INFO - Epoch 12/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:31:36,512 - cnn_lstm_attention_model - INFO - Epoch 13/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:31:39,417 - cnn_lstm_attention_model - INFO - Epoch 14/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:31:42,357 - cnn_lstm_attention_model - INFO - Epoch 15/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:31:45,245 - cnn_lstm_attention_model - INFO - Epoch 16/20, Train Loss: 0.0111, Val Loss: 0.0091
2025-05-15 16:31:48,047 - cnn_lstm_attention_model - INFO - Epoch 17/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:31:50,918 - cnn_lstm_attention_model - INFO - Epoch 18/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:31:53,913 - cnn_lstm_attention_model - INFO - Epoch 19/20, Train Loss: 0.0111, Val Loss: 0.0089
2025-05-15 16:31:56,801 - cnn_lstm_attention_model - INFO - Epoch 20/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:31:56,801 - cnn_lstm_attention_model - INFO - Loaded best model state for CNN-LSTM-Attention.
2025-05-15 16:31:57,050 - evaluation - INFO - 模型 CNN-LSTM-Attention 评估结果:
2025-05-15 16:31:57,050 - evaluation - INFO - RMSE: 42.8331
2025-05-15 16:31:57,050 - evaluation - INFO - MAE: 34.8865
2025-05-15 16:31:57,050 - evaluation - INFO - R²: -0.0471
2025-05-15 16:31:57,050 - evaluation - INFO - MAPE: 110.5433%
2025-05-15 16:31:57,050 - evaluation - INFO - 执行时间: 55.1044 秒
2025-05-15 16:31:57,346 - time_series - INFO - CNN-LSTM-Attention模型完成，评估结果: RMSE=42.8331, MAE=34.8865, R2=-0.0471
2025-05-15 16:31:57,980 - time_series - INFO - 所有有效结果已保存到 time_series/results\all_models_comparison.xlsx
2025-05-15 16:31:57,984 - time_series - INFO - 时间序列预测系统运行完成
