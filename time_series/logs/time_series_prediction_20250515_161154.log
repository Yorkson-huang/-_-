2025-05-15 16:11:54,998 - time_series - INFO - 开始运行时间序列预测系统
2025-05-15 16:11:54,998 - time_series - INFO - 日志文件: time_series/logs\time_series_prediction_20250515_161154.log
2025-05-15 16:11:54,998 - data_utils - INFO - 正在加载数据集: time_series\北京-逐日.xlsx
2025-05-15 16:11:56,442 - data_utils - INFO - 数据集加载成功，形状: (27814, 3)
2025-05-15 16:11:56,443 - data_utils - INFO - 提取的AQI数据形状: (27814,)
2025-05-15 16:11:56,462 - data_utils - INFO - 创建的序列形状: X=(27807, 7), y=(27807,)
2025-05-15 16:11:56,464 - data_utils - INFO - 训练集形状: X=(19464, 7), y=(19464,)
2025-05-15 16:11:56,464 - data_utils - INFO - 验证集形状: X=(2780, 7), y=(2780,)
2025-05-15 16:11:56,466 - data_utils - INFO - 测试集形状: X=(5563, 7), y=(5563,)
2025-05-15 16:11:56,466 - data_processor - INFO - 数据处理器初始化，序列长度: 7, 批次大小: 32
2025-05-15 16:11:56,466 - time_series - INFO - ==================================================
2025-05-15 16:11:56,466 - time_series - INFO - 开始LSTM模型训练和预测
2025-05-15 16:11:56,472 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:11:56,472 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:11:56,473 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:11:56,473 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:11:59,549 - lstm_model - INFO - LSTM模型初始化，设备: cuda
2025-05-15 16:11:59,549 - lstm_model - INFO - 模型结构: 输入大小=1, 隐藏大小=64, 层数=2
2025-05-15 16:11:59,549 - lstm_model - INFO - 开始训练LSTM模型，总共20个周期
2025-05-15 16:12:01,524 - lstm_model - INFO - 周期 1/20, 训练损失: 0.002642, 验证损失: 0.001771
2025-05-15 16:12:01,524 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:03,316 - lstm_model - INFO - 周期 2/20, 训练损失: 0.001070, 验证损失: 0.001258
2025-05-15 16:12:03,316 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:05,161 - lstm_model - INFO - 周期 3/20, 训练损失: 0.000890, 验证损失: 0.001062
2025-05-15 16:12:05,161 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:06,932 - lstm_model - INFO - 周期 4/20, 训练损失: 0.000871, 验证损失: 0.001091
2025-05-15 16:12:09,409 - lstm_model - INFO - 周期 5/20, 训练损失: 0.000826, 验证损失: 0.001352
2025-05-15 16:12:11,215 - lstm_model - INFO - 周期 6/20, 训练损失: 0.000824, 验证损失: 0.001049
2025-05-15 16:12:11,219 - lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:13,049 - lstm_model - INFO - 周期 7/20, 训练损失: 0.000822, 验证损失: 0.001282
2025-05-15 16:12:14,815 - lstm_model - INFO - 周期 8/20, 训练损失: 0.000807, 验证损失: 0.001332
2025-05-15 16:12:16,577 - lstm_model - INFO - 周期 9/20, 训练损失: 0.000811, 验证损失: 0.001166
2025-05-15 16:12:18,431 - lstm_model - INFO - 周期 10/20, 训练损失: 0.000803, 验证损失: 0.001111
2025-05-15 16:12:20,165 - lstm_model - INFO - 周期 11/20, 训练损失: 0.000787, 验证损失: 0.001084
2025-05-15 16:12:22,029 - lstm_model - INFO - 周期 12/20, 训练损失: 0.000804, 验证损失: 0.001066
2025-05-15 16:12:23,919 - lstm_model - INFO - 周期 13/20, 训练损失: 0.000778, 验证损失: 0.001109
2025-05-15 16:12:25,825 - lstm_model - INFO - 周期 14/20, 训练损失: 0.000779, 验证损失: 0.001068
2025-05-15 16:12:27,675 - lstm_model - INFO - 周期 15/20, 训练损失: 0.000768, 验证损失: 0.001105
2025-05-15 16:12:29,506 - lstm_model - INFO - 周期 16/20, 训练损失: 0.000770, 验证损失: 0.001179
2025-05-15 16:12:29,506 - lstm_model - INFO - 早停触发，10个周期内验证损失未改善
2025-05-15 16:12:29,518 - lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:12:29,698 - evaluation - INFO - 模型 LSTM 评估结果:
2025-05-15 16:12:29,698 - evaluation - INFO - RMSE: 8.9377
2025-05-15 16:12:29,698 - evaluation - INFO - MAE: 5.5483
2025-05-15 16:12:29,698 - evaluation - INFO - R²: 0.9544
2025-05-15 16:12:29,698 - evaluation - INFO - MAPE: 14.9536%
2025-05-15 16:12:29,698 - evaluation - INFO - 执行时间: 29.9731 秒
2025-05-15 16:12:30,057 - time_series - INFO - LSTM模型完成，评估结果: RMSE=8.9377, MAE=5.5483
2025-05-15 16:12:30,057 - time_series - INFO - ==================================================
2025-05-15 16:12:30,057 - time_series - INFO - 开始CNN模型训练和预测
2025-05-15 16:12:30,057 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:12:30,057 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:12:30,057 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:12:30,057 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:12:30,060 - cnn_model - INFO - CNN模型初始化，设备: cuda
2025-05-15 16:12:30,060 - cnn_model - INFO - 模型结构: 输入通道=1, 序列长度=7
2025-05-15 16:12:30,060 - cnn_model - INFO - 开始训练CNN模型，总共20个周期
2025-05-15 16:12:32,771 - cnn_model - INFO - 周期 1/20, 训练损失: 0.002965, 验证损失: 0.002475
2025-05-15 16:12:32,775 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:34,577 - cnn_model - INFO - 周期 2/20, 训练损失: 0.001366, 验证损失: 0.002020
2025-05-15 16:12:34,579 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:36,299 - cnn_model - INFO - 周期 3/20, 训练损失: 0.001166, 验证损失: 0.001834
2025-05-15 16:12:36,304 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:37,871 - cnn_model - INFO - 周期 4/20, 训练损失: 0.001090, 验证损失: 0.001657
2025-05-15 16:12:37,873 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:39,335 - cnn_model - INFO - 周期 5/20, 训练损失: 0.001061, 验证损失: 0.002287
2025-05-15 16:12:40,812 - cnn_model - INFO - 周期 6/20, 训练损失: 0.001040, 验证损失: 0.001518
2025-05-15 16:12:40,826 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:42,348 - cnn_model - INFO - 周期 7/20, 训练损失: 0.000989, 验证损失: 0.001390
2025-05-15 16:12:42,350 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:44,110 - cnn_model - INFO - 周期 8/20, 训练损失: 0.000957, 验证损失: 0.001520
2025-05-15 16:12:45,773 - cnn_model - INFO - 周期 9/20, 训练损失: 0.000953, 验证损失: 0.001649
2025-05-15 16:12:47,675 - cnn_model - INFO - 周期 10/20, 训练损失: 0.000910, 验证损失: 0.001443
2025-05-15 16:12:49,228 - cnn_model - INFO - 周期 11/20, 训练损失: 0.000900, 验证损失: 0.001297
2025-05-15 16:12:49,230 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:51,176 - cnn_model - INFO - 周期 12/20, 训练损失: 0.000880, 验证损失: 0.001399
2025-05-15 16:12:52,812 - cnn_model - INFO - 周期 13/20, 训练损失: 0.000863, 验证损失: 0.001395
2025-05-15 16:12:54,331 - cnn_model - INFO - 周期 14/20, 训练损失: 0.000849, 验证损失: 0.001356
2025-05-15 16:12:55,844 - cnn_model - INFO - 周期 15/20, 训练损失: 0.000855, 验证损失: 0.001422
2025-05-15 16:12:57,538 - cnn_model - INFO - 周期 16/20, 训练损失: 0.000843, 验证损失: 0.001272
2025-05-15 16:12:57,540 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:12:59,145 - cnn_model - INFO - 周期 17/20, 训练损失: 0.000832, 验证损失: 0.001364
2025-05-15 16:13:00,776 - cnn_model - INFO - 周期 18/20, 训练损失: 0.000837, 验证损失: 0.001353
2025-05-15 16:13:02,717 - cnn_model - INFO - 周期 19/20, 训练损失: 0.000828, 验证损失: 0.001241
2025-05-15 16:13:02,719 - cnn_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:13:04,333 - cnn_model - INFO - 周期 20/20, 训练损失: 0.000804, 验证损失: 0.001345
2025-05-15 16:13:04,348 - cnn_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:13:04,527 - evaluation - INFO - 模型 CNN 评估结果:
2025-05-15 16:13:04,527 - evaluation - INFO - RMSE: 9.5990
2025-05-15 16:13:04,527 - evaluation - INFO - MAE: 5.9805
2025-05-15 16:13:04,527 - evaluation - INFO - R²: 0.9474
2025-05-15 16:13:04,527 - evaluation - INFO - MAPE: 15.8498%
2025-05-15 16:13:04,527 - evaluation - INFO - 执行时间: 34.2887 秒
2025-05-15 16:13:04,779 - time_series - INFO - CNN模型完成，评估结果: RMSE=9.5990, MAE=5.9805
2025-05-15 16:13:04,781 - time_series - INFO - ==================================================
2025-05-15 16:13:04,781 - time_series - INFO - 开始CNN+LSTM模型训练和预测
2025-05-15 16:13:04,782 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:13:04,782 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:13:04,782 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:13:04,782 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:13:04,782 - cnn_lstm_model - INFO - CNN+LSTM模型初始化，设备: cuda
2025-05-15 16:13:04,786 - cnn_lstm_model - INFO - 模型结构: 输入通道=1, 序列长度=7, LSTM隐藏大小=64
2025-05-15 16:13:04,786 - cnn_lstm_model - INFO - 开始训练CNN+LSTM模型，总共20个周期
2025-05-15 16:13:06,774 - cnn_lstm_model - INFO - 周期 1/20, 训练损失: 0.002362, 验证损失: 0.002113
2025-05-15 16:13:06,776 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:13:08,763 - cnn_lstm_model - INFO - 周期 2/20, 训练损失: 0.001182, 验证损失: 0.001781
2025-05-15 16:13:08,767 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:13:10,813 - cnn_lstm_model - INFO - 周期 3/20, 训练损失: 0.001113, 验证损失: 0.001930
2025-05-15 16:13:12,809 - cnn_lstm_model - INFO - 周期 4/20, 训练损失: 0.001057, 验证损失: 0.001571
2025-05-15 16:13:12,811 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:13:15,070 - cnn_lstm_model - INFO - 周期 5/20, 训练损失: 0.001027, 验证损失: 0.001733
2025-05-15 16:13:17,449 - cnn_lstm_model - INFO - 周期 6/20, 训练损失: 0.001012, 验证损失: 0.001483
2025-05-15 16:13:17,453 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:13:19,761 - cnn_lstm_model - INFO - 周期 7/20, 训练损失: 0.000985, 验证损失: 0.001655
2025-05-15 16:13:21,688 - cnn_lstm_model - INFO - 周期 8/20, 训练损失: 0.000989, 验证损失: 0.001585
2025-05-15 16:13:23,785 - cnn_lstm_model - INFO - 周期 9/20, 训练损失: 0.000957, 验证损失: 0.001424
2025-05-15 16:13:23,787 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:13:25,786 - cnn_lstm_model - INFO - 周期 10/20, 训练损失: 0.000935, 验证损失: 0.001461
2025-05-15 16:13:27,877 - cnn_lstm_model - INFO - 周期 11/20, 训练损失: 0.000932, 验证损失: 0.001435
2025-05-15 16:13:30,308 - cnn_lstm_model - INFO - 周期 12/20, 训练损失: 0.000935, 验证损失: 0.001432
2025-05-15 16:13:32,163 - cnn_lstm_model - INFO - 周期 13/20, 训练损失: 0.000917, 验证损失: 0.001427
2025-05-15 16:13:33,998 - cnn_lstm_model - INFO - 周期 14/20, 训练损失: 0.000912, 验证损失: 0.001436
2025-05-15 16:13:35,854 - cnn_lstm_model - INFO - 周期 15/20, 训练损失: 0.000904, 验证损失: 0.001284
2025-05-15 16:13:35,855 - cnn_lstm_model - INFO - 模型改进，已保存最佳模型
2025-05-15 16:13:37,755 - cnn_lstm_model - INFO - 周期 16/20, 训练损失: 0.000891, 验证损失: 0.001376
2025-05-15 16:13:39,673 - cnn_lstm_model - INFO - 周期 17/20, 训练损失: 0.000889, 验证损失: 0.001319
2025-05-15 16:13:41,595 - cnn_lstm_model - INFO - 周期 18/20, 训练损失: 0.000871, 验证损失: 0.001293
2025-05-15 16:13:43,464 - cnn_lstm_model - INFO - 周期 19/20, 训练损失: 0.000870, 验证损失: 0.001358
2025-05-15 16:13:45,318 - cnn_lstm_model - INFO - 周期 20/20, 训练损失: 0.000838, 验证损失: 0.001331
2025-05-15 16:13:45,334 - cnn_lstm_model - INFO - 训练完成，已加载最佳模型
2025-05-15 16:13:45,560 - evaluation - INFO - 模型 CNN+LSTM 评估结果:
2025-05-15 16:13:45,560 - evaluation - INFO - RMSE: 11.5235
2025-05-15 16:13:45,560 - evaluation - INFO - MAE: 8.6164
2025-05-15 16:13:45,560 - evaluation - INFO - R²: 0.9242
2025-05-15 16:13:45,560 - evaluation - INFO - MAPE: 26.5757%
2025-05-15 16:13:45,560 - evaluation - INFO - 执行时间: 40.5484 秒
2025-05-15 16:13:45,821 - time_series - INFO - CNN+LSTM模型完成，评估结果: RMSE=11.5235, MAE=8.6164
2025-05-15 16:13:45,821 - time_series - INFO - ==================================================
2025-05-15 16:13:45,821 - time_series - INFO - 开始Sklearn模型训练和预测
2025-05-15 16:13:45,821 - data_processor - INFO - Sklearn数据准备完成
2025-05-15 16:13:45,821 - data_processor - INFO - 重塑后的训练数据形状: (19464, 7)
2025-05-15 16:13:45,821 - data_processor - INFO - 重塑后的验证数据形状: (2780, 7)
2025-05-15 16:13:45,823 - data_processor - INFO - 重塑后的测试数据形状: (5563, 7)
2025-05-15 16:13:45,823 - sklearn_models - INFO - 初始化Sklearn模型集合
2025-05-15 16:13:45,824 - time_series - INFO - ------------------------------
2025-05-15 16:13:45,824 - time_series - INFO - 训练线性回归模型
2025-05-15 16:13:45,824 - sklearn_models - INFO - 训练线性回归模型
2025-05-15 16:13:45,825 - sklearn_models - INFO - 线性回归模型验证R²得分: 0.8776
2025-05-15 16:13:45,825 - sklearn_models - INFO - 使用 linear_regression 模型进行预测
2025-05-15 16:13:45,831 - evaluation - INFO - 模型 线性回归 评估结果:
2025-05-15 16:13:45,831 - evaluation - INFO - RMSE: 8.8401
2025-05-15 16:13:45,831 - evaluation - INFO - MAE: 5.1610
2025-05-15 16:13:45,831 - evaluation - INFO - R²: 0.9554
2025-05-15 16:13:45,832 - evaluation - INFO - MAPE: 12.8423%
2025-05-15 16:13:45,832 - evaluation - INFO - 执行时间: 0.0015 秒
2025-05-15 16:13:46,092 - time_series - INFO - ------------------------------
2025-05-15 16:13:46,092 - time_series - INFO - 训练决策树模型
2025-05-15 16:13:46,093 - sklearn_models - INFO - 训练决策树模型，参数: {'max_depth': 10, 'random_state': 42}
2025-05-15 16:13:46,149 - sklearn_models - INFO - 决策树模型验证R²得分: 0.8601
2025-05-15 16:13:46,150 - sklearn_models - INFO - 使用 decision_tree 模型进行预测
2025-05-15 16:13:46,152 - evaluation - INFO - 模型 决策树 评估结果:
2025-05-15 16:13:46,152 - evaluation - INFO - RMSE: 9.4953
2025-05-15 16:13:46,152 - evaluation - INFO - MAE: 5.3617
2025-05-15 16:13:46,152 - evaluation - INFO - R²: 0.9485
2025-05-15 16:13:46,153 - evaluation - INFO - MAPE: 12.6134%
2025-05-15 16:13:46,153 - evaluation - INFO - 执行时间: 0.0582 秒
2025-05-15 16:13:46,420 - time_series - INFO - ------------------------------
2025-05-15 16:13:46,420 - time_series - INFO - 训练随机森林模型
2025-05-15 16:13:46,420 - sklearn_models - INFO - 训练随机森林模型，参数: {'n_estimators': 100, 'max_depth': 10, 'random_state': 42}
2025-05-15 16:13:50,323 - sklearn_models - INFO - 随机森林模型验证R²得分: 0.8886
2025-05-15 16:13:50,323 - sklearn_models - INFO - 使用 random_forest 模型进行预测
2025-05-15 16:13:50,364 - evaluation - INFO - 模型 随机森林 评估结果:
2025-05-15 16:13:50,365 - evaluation - INFO - RMSE: 8.7157
2025-05-15 16:13:50,365 - evaluation - INFO - MAE: 4.9895
2025-05-15 16:13:50,365 - evaluation - INFO - R²: 0.9566
2025-05-15 16:13:50,365 - evaluation - INFO - MAPE: 12.2481%
2025-05-15 16:13:50,366 - evaluation - INFO - 执行时间: 3.9027 秒
2025-05-15 16:13:50,616 - time_series - INFO - ------------------------------
2025-05-15 16:13:50,616 - time_series - INFO - 训练XGBoost模型
2025-05-15 16:13:50,616 - sklearn_models - INFO - 训练XGBoost模型，参数: {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'objective': 'reg:squarederror', 'random_state': 42}
2025-05-15 16:13:50,792 - sklearn_models - INFO - XGBoost模型验证R²得分: 0.8776
2025-05-15 16:13:50,792 - sklearn_models - INFO - 使用 xgboost 模型进行预测
2025-05-15 16:13:50,796 - evaluation - INFO - 模型 XGBoost 评估结果:
2025-05-15 16:13:50,796 - evaluation - INFO - RMSE: 8.7086
2025-05-15 16:13:50,796 - evaluation - INFO - MAE: 4.9935
2025-05-15 16:13:50,796 - evaluation - INFO - R²: 0.9567
2025-05-15 16:13:50,796 - evaluation - INFO - MAPE: 12.2249%
2025-05-15 16:13:50,796 - evaluation - INFO - 执行时间: 0.1754 秒
2025-05-15 16:13:51,083 - time_series - INFO - ------------------------------
2025-05-15 16:13:51,083 - time_series - INFO - 训练SVM模型
2025-05-15 16:13:51,083 - sklearn_models - INFO - 训练SVM模型，参数: {'kernel': 'rbf', 'C': 1.0, 'epsilon': 0.1}
2025-05-15 16:13:51,588 - sklearn_models - INFO - SVM模型验证R²得分: 0.7728
2025-05-15 16:13:51,588 - sklearn_models - INFO - 使用 svm 模型进行预测
2025-05-15 16:13:51,707 - evaluation - INFO - 模型 SVM 评估结果:
2025-05-15 16:13:51,707 - evaluation - INFO - RMSE: 21.3378
2025-05-15 16:13:51,709 - evaluation - INFO - MAE: 18.0252
2025-05-15 16:13:51,709 - evaluation - INFO - R²: 0.7402
2025-05-15 16:13:51,709 - evaluation - INFO - MAPE: 67.9728%
2025-05-15 16:13:51,709 - evaluation - INFO - 执行时间: 0.5046 秒
2025-05-15 16:13:51,980 - time_series - INFO - ------------------------------
2025-05-15 16:13:51,980 - time_series - INFO - 训练梯度提升树模型
2025-05-15 16:13:51,980 - sklearn_models - INFO - 训练Gradient Boosting模型，参数: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': 3, 'random_state': 42}
2025-05-15 16:13:53,802 - sklearn_models - INFO - Gradient Boosting模型验证R²得分: 0.8632
2025-05-15 16:13:53,802 - sklearn_models - INFO - 使用 gradient_boosting 模型进行预测
2025-05-15 16:13:53,806 - evaluation - INFO - 模型 梯度提升树 评估结果:
2025-05-15 16:13:53,806 - evaluation - INFO - RMSE: 8.7235
2025-05-15 16:13:53,806 - evaluation - INFO - MAE: 5.1766
2025-05-15 16:13:53,806 - evaluation - INFO - R²: 0.9566
2025-05-15 16:13:53,806 - evaluation - INFO - MAPE: 13.0284%
2025-05-15 16:13:53,808 - evaluation - INFO - 执行时间: 1.8214 秒
2025-05-15 16:13:54,111 - time_series - INFO - ------------------------------
2025-05-15 16:13:54,114 - time_series - INFO - 训练LightGBM模型
2025-05-15 16:13:54,114 - sklearn_models - INFO - 训练LightGBM模型，参数: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'random_state': 42, 'verbose': -1}
2025-05-15 16:13:54,374 - sklearn_models - INFO - LightGBM模型验证R²得分: 0.8872
2025-05-15 16:13:54,374 - sklearn_models - INFO - 使用 lightgbm 模型进行预测
2025-05-15 16:13:54,386 - evaluation - INFO - 模型 LightGBM 评估结果:
2025-05-15 16:13:54,386 - evaluation - INFO - RMSE: 8.8139
2025-05-15 16:13:54,387 - evaluation - INFO - MAE: 5.0413
2025-05-15 16:13:54,387 - evaluation - INFO - R²: 0.9557
2025-05-15 16:13:54,387 - evaluation - INFO - MAPE: 12.3964%
2025-05-15 16:13:54,387 - evaluation - INFO - 执行时间: 0.2609 秒
2025-05-15 16:13:54,675 - time_series - INFO - ------------------------------
2025-05-15 16:13:54,675 - time_series - INFO - 训练CatBoost模型
2025-05-15 16:13:54,675 - sklearn_models - INFO - 训练CatBoost模型，参数: {'iterations': 100, 'learning_rate': 0.1, 'depth': 6, 'random_state': 42, 'verbose': 0}
2025-05-15 16:13:55,632 - sklearn_models - INFO - CatBoost模型验证R²得分: 0.8789
2025-05-15 16:13:55,633 - sklearn_models - INFO - 使用 catboost 模型进行预测
2025-05-15 16:13:55,653 - evaluation - INFO - 模型 CatBoost 评估结果:
2025-05-15 16:13:55,653 - evaluation - INFO - RMSE: 8.9734
2025-05-15 16:13:55,653 - evaluation - INFO - MAE: 5.3235
2025-05-15 16:13:55,653 - evaluation - INFO - R²: 0.9540
2025-05-15 16:13:55,653 - evaluation - INFO - MAPE: 13.4418%
2025-05-15 16:13:55,653 - evaluation - INFO - 执行时间: 0.9583 秒
2025-05-15 16:13:55,987 - time_series - INFO - 所有Sklearn模型训练完成
2025-05-15 16:13:55,991 - time_series - INFO - ==================================================
2025-05-15 16:13:55,991 - time_series - INFO - 开始ARIMA模型训练和预测
2025-05-15 16:13:55,991 - time_series - ERROR - 运行ARIMA模型时发生错误: 'TimeSeriesDataProcessor' object has no attribute 'data_dict'
2025-05-15 16:13:55,992 - time_series - INFO - ==================================================
2025-05-15 16:13:55,992 - time_series - INFO - 开始Prophet模型训练和预测
2025-05-15 16:13:55,992 - time_series - WARNING - Prophet模型：未找到明确的 '日期' 列，将尝试使用索引生成日期。
2025-05-15 16:13:55,992 - time_series - INFO - Prophet模型：将使用第一列 'date' 作为日期列。
2025-05-15 16:13:56,006 - time_series - ERROR - 运行Prophet模型时发生错误: 'TimeSeriesDataProcessor' object has no attribute 'data_dict'
2025-05-15 16:13:56,007 - time_series - INFO - ==================================================
2025-05-15 16:13:56,007 - time_series - INFO - 开始Transformer模型训练和预测
2025-05-15 16:13:56,008 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:13:56,008 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:13:56,008 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:13:56,009 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:13:56,053 - transformer_model - INFO - TransformerModel initialized on cuda
2025-05-15 16:13:56,057 - transformer_model - INFO - Model params: input_size=1, d_model=64, nhead=4, layers=2, ff_dim=128, output_size=1, seq_len=7
2025-05-15 16:13:56,057 - transformer_model - INFO - Starting Transformer training for 20 epochs.
2025-05-15 16:14:02,210 - transformer_model - INFO - Epoch 1/20, Train Loss: 0.0547, Val Loss: 0.0086
2025-05-15 16:14:02,210 - transformer_model - INFO - New best validation loss: 0.0086. Saving model state.
2025-05-15 16:14:08,106 - transformer_model - INFO - Epoch 2/20, Train Loss: 0.0151, Val Loss: 0.0106
2025-05-15 16:14:14,797 - transformer_model - INFO - Epoch 3/20, Train Loss: 0.0131, Val Loss: 0.0140
2025-05-15 16:14:22,485 - transformer_model - INFO - Epoch 4/20, Train Loss: 0.0124, Val Loss: 0.0089
2025-05-15 16:14:28,329 - transformer_model - INFO - Epoch 5/20, Train Loss: 0.0119, Val Loss: 0.0091
2025-05-15 16:14:34,763 - transformer_model - INFO - Epoch 6/20, Train Loss: 0.0116, Val Loss: 0.0105
2025-05-15 16:14:40,651 - transformer_model - INFO - Epoch 7/20, Train Loss: 0.0115, Val Loss: 0.0086
2025-05-15 16:14:46,588 - transformer_model - INFO - Epoch 8/20, Train Loss: 0.0114, Val Loss: 0.0087
2025-05-15 16:14:53,089 - transformer_model - INFO - Epoch 9/20, Train Loss: 0.0114, Val Loss: 0.0087
2025-05-15 16:14:58,849 - transformer_model - INFO - Epoch 10/20, Train Loss: 0.0115, Val Loss: 0.0090
2025-05-15 16:15:04,775 - transformer_model - INFO - Epoch 11/20, Train Loss: 0.0114, Val Loss: 0.0092
2025-05-15 16:15:11,835 - transformer_model - INFO - Epoch 12/20, Train Loss: 0.0113, Val Loss: 0.0086
2025-05-15 16:15:11,835 - transformer_model - INFO - New best validation loss: 0.0086. Saving model state.
2025-05-15 16:15:18,070 - transformer_model - INFO - Epoch 13/20, Train Loss: 0.0114, Val Loss: 0.0088
2025-05-15 16:15:24,606 - transformer_model - INFO - Epoch 14/20, Train Loss: 0.0112, Val Loss: 0.0088
2025-05-15 16:15:30,752 - transformer_model - INFO - Epoch 15/20, Train Loss: 0.0112, Val Loss: 0.0086
2025-05-15 16:15:36,600 - transformer_model - INFO - Epoch 16/20, Train Loss: 0.0112, Val Loss: 0.0088
2025-05-15 16:15:42,155 - transformer_model - INFO - Epoch 17/20, Train Loss: 0.0112, Val Loss: 0.0086
2025-05-15 16:15:47,666 - transformer_model - INFO - Epoch 18/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:15:53,127 - transformer_model - INFO - Epoch 19/20, Train Loss: 0.0112, Val Loss: 0.0094
2025-05-15 16:15:58,951 - transformer_model - INFO - Epoch 20/20, Train Loss: 0.0112, Val Loss: 0.0087
2025-05-15 16:15:58,951 - transformer_model - INFO - Loaded best model state for Transformer.
2025-05-15 16:15:59,253 - evaluation - INFO - 模型 Transformer 评估结果:
2025-05-15 16:15:59,253 - evaluation - INFO - RMSE: 44.9632
2025-05-15 16:15:59,253 - evaluation - INFO - MAE: 37.3116
2025-05-15 16:15:59,253 - evaluation - INFO - R²: -0.1538
2025-05-15 16:15:59,253 - evaluation - INFO - MAPE: 120.1351%
2025-05-15 16:15:59,264 - evaluation - INFO - 执行时间: 122.8938 秒
2025-05-15 16:15:59,523 - time_series - INFO - Transformer模型完成，评估结果: RMSE=44.9632, MAE=37.3116, R2=-0.1538
2025-05-15 16:15:59,523 - time_series - INFO - ==================================================
2025-05-15 16:15:59,523 - time_series - INFO - 开始CNN-LSTM-Attention模型训练和预测
2025-05-15 16:15:59,524 - data_processor - INFO - PyTorch数据准备完成
2025-05-15 16:15:59,524 - data_processor - INFO - 训练批次数: 609
2025-05-15 16:15:59,524 - data_processor - INFO - 验证批次数: 87
2025-05-15 16:15:59,524 - data_processor - INFO - 测试批次数: 174
2025-05-15 16:15:59,527 - cnn_lstm_attention_model - INFO - CNNLSTMAttentionModel initialized on cuda
2025-05-15 16:15:59,527 - cnn_lstm_attention_model - INFO - Model params: input_channels=1, seq_length=7, lstm_hidden=64, cnn_out=32
2025-05-15 16:15:59,527 - cnn_lstm_attention_model - INFO - Starting CNN-LSTM-Attention training for 20 epochs.
2025-05-15 16:16:02,516 - cnn_lstm_attention_model - INFO - Epoch 1/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:02,520 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0087. Saving model state.
2025-05-15 16:16:05,558 - cnn_lstm_attention_model - INFO - Epoch 2/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:05,558 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0087. Saving model state.
2025-05-15 16:16:08,556 - cnn_lstm_attention_model - INFO - Epoch 3/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:16:08,556 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0086. Saving model state.
2025-05-15 16:16:11,058 - cnn_lstm_attention_model - INFO - Epoch 4/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:16:13,570 - cnn_lstm_attention_model - INFO - Epoch 5/20, Train Loss: 0.0111, Val Loss: 0.0085
2025-05-15 16:16:13,570 - cnn_lstm_attention_model - INFO - New best validation loss: 0.0085. Saving model state.
2025-05-15 16:16:16,023 - cnn_lstm_attention_model - INFO - Epoch 6/20, Train Loss: 0.0111, Val Loss: 0.0085
2025-05-15 16:16:18,468 - cnn_lstm_attention_model - INFO - Epoch 7/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:16:20,976 - cnn_lstm_attention_model - INFO - Epoch 8/20, Train Loss: 0.0111, Val Loss: 0.0088
2025-05-15 16:16:23,465 - cnn_lstm_attention_model - INFO - Epoch 9/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:26,310 - cnn_lstm_attention_model - INFO - Epoch 10/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:16:29,325 - cnn_lstm_attention_model - INFO - Epoch 11/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:31,958 - cnn_lstm_attention_model - INFO - Epoch 12/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:34,434 - cnn_lstm_attention_model - INFO - Epoch 13/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:16:37,262 - cnn_lstm_attention_model - INFO - Epoch 14/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:39,753 - cnn_lstm_attention_model - INFO - Epoch 15/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:16:42,358 - cnn_lstm_attention_model - INFO - Epoch 16/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:44,759 - cnn_lstm_attention_model - INFO - Epoch 17/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:47,150 - cnn_lstm_attention_model - INFO - Epoch 18/20, Train Loss: 0.0111, Val Loss: 0.0087
2025-05-15 16:16:49,708 - cnn_lstm_attention_model - INFO - Epoch 19/20, Train Loss: 0.0112, Val Loss: 0.0087
2025-05-15 16:16:52,446 - cnn_lstm_attention_model - INFO - Epoch 20/20, Train Loss: 0.0111, Val Loss: 0.0086
2025-05-15 16:16:52,446 - cnn_lstm_attention_model - INFO - Loaded best model state for CNN-LSTM-Attention.
2025-05-15 16:16:52,696 - evaluation - INFO - 模型 CNN-LSTM-Attention 评估结果:
2025-05-15 16:16:52,696 - evaluation - INFO - RMSE: 43.0192
2025-05-15 16:16:52,696 - evaluation - INFO - MAE: 35.0699
2025-05-15 16:16:52,696 - evaluation - INFO - R²: -0.0562
2025-05-15 16:16:52,697 - evaluation - INFO - MAPE: 111.3718%
2025-05-15 16:16:52,697 - evaluation - INFO - 执行时间: 52.9185 秒
2025-05-15 16:16:52,976 - time_series - INFO - CNN-LSTM-Attention模型完成，评估结果: RMSE=43.0192, MAE=35.0699, R2=-0.0562
2025-05-15 16:16:53,630 - time_series - INFO - 所有有效结果已保存到 time_series/results\all_models_comparison.xlsx
2025-05-15 16:16:53,630 - time_series - INFO - 时间序列预测系统运行完成
